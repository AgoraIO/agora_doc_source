<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="api_imediarecorder_startrecording">
    <title><ph keyref="startRecording"/></title>
    <shortdesc id="short"><ph id="shortdesc" props="electron">Starts recording audio and video streams.</ph><ph id="shortdesc" props="rn">Starts audio and video stream recording.</ph><ph id="shortdesc" props="flutter">Starts audio and video stream recording.</ph><ph id="shortdesc" props="unity">Starts audio and video stream recording.</ph></shortdesc>
    <prolog>
        <metadata>
            <keywords>
                <indexterm keyref="startRecording"/>
            </keywords>
        </metadata>
    </prolog>
    <refbody>
        <section id="prototype">
            <p outputclass="codeblock">
                <codeblock props="electron" outputclass="language-typescript">abstract startRecording(config: MediaRecorderConfiguration): number;</codeblock>
                <codeblock props="rn" outputclass="language-typescript">abstract startRecording(config: MediaRecorderConfiguration): number;</codeblock>
                <codeblock props="flutter" outputclass="language-dart">Future&lt;void&gt; startRecording(MediaRecorderConfiguration config);</codeblock>
                <codeblock props="unity" outputclass="language-csharp">public abstract int StartRecording(MediaRecorderConfiguration config);</codeblock>
            </p>
        </section>
        <section id="detailed_desc" deliveryTarget="details" otherprops="no-title">
            <p props="electron">This method starts recording audio and video streams. The Agora SDK supports recording both local and remote users' audio and video streams simultaneously.
Before starting recording, ensure that:
                <ul>
                    <li>You have created a media recorder object using <xref keyref="createMediaRecorder"/>.</li>
                    <li>You have registered a recorder observer using <xref keyref="setMediaRecorderObserver"/> to listen for recording-related callbacks.</li>
                    <li>You have joined a channel.</li>
                </ul><ph>This method supports recording the following data:</ph>
                <ul>
                    <li>Audio collected from the microphone in AAC format.</li>
                    <li>Video collected from the camera in H.264 or H.265 format.</li>
                </ul><ph>After recording starts, if the video resolution changes during recording, the SDK stops recording; if the audio sampling rate or number of channels changes, the SDK continues recording and generates a single MP4 file.</ph><ph>Recording files are generated only when recordable audio or video streams are detected. If there are no recordable streams, or if the streams are interrupted for more than 5 seconds during recording, the SDK stops recording and triggers the <xref keyref="onRecorderStateChanged"/>(<codeph>RecorderStateError, RecorderErrorNoStream</codeph>) callback.</ph></p>
            <p props="rn">This method is used to start recording audio and video streams. The Agora SDK supports recording both local and remote user audio and video streams simultaneously.
Before starting recording, ensure the following:
                <ul>
                    <li>You have created a media recorder object using <xref keyref="createMediaRecorder"/>.</li>
                    <li>You have registered a recorder observer using <xref keyref="setMediaRecorderObserver"/> to listen for recording callbacks.</li>
                    <li>You have joined a channel.</li>
                </ul><ph>This method supports recording the following data:</ph>
                <ul>
                    <li>Audio captured by the microphone in AAC format.</li>
                    <li>Video captured by the camera in H.264 or H.265 format.</li>
                </ul><ph>After starting recording, if the video resolution changes during recording, the SDK stops recording; if the audio sample rate or number of channels changes, the SDK continues recording and generates a single MP4 file.</ph><ph>A recording file can only be successfully generated when a recordable audio or video stream is detected. If there is no recordable stream, or if the stream is interrupted for more than 5 seconds during recording, the SDK stops recording and triggers the <xref keyref="onRecorderStateChanged"/>(<codeph>RecorderStateError, RecorderErrorNoStream</codeph>) callback.</ph></p>
            <p props="flutter">This method starts recording audio and video streams. The Agora SDK supports recording both local and remote users' audio and video streams simultaneously.
Before starting recording, ensure the following:
                <ul>
                    <li>You have created a media recorder object using <xref keyref="createMediaRecorder"/>.</li>
                    <li>You have registered a recorder observer using <xref keyref="setMediaRecorderObserver"/> to listen for recording-related callbacks.</li>
                    <li>You have joined a channel.</li>
                </ul><ph>This method supports recording the following data:</ph>
                <ul>
                    <li>Audio captured from the microphone in AAC format.</li>
                    <li>Video captured from the camera in H.264 or H.265 format.</li>
                </ul><ph>After recording starts, if the video resolution changes during recording, the SDK stops recording; if the audio sample rate or number of channels changes, the SDK continues recording and generates a single MP4 recording file.</ph><ph>A recording file is only generated when recordable audio or video streams are detected. If there are no recordable streams or if the streams are interrupted for more than 5 seconds during recording, the SDK stops recording and triggers the <xref keyref="onRecorderStateChanged"/> (<codeph>recorderStateError, recorderReasonNoStream</codeph>) callback.</ph></p>
            <p props="unity">This method starts audio and video stream recording. The SDK supports recording both local and remote users' audio and video streams.
Before starting recording, ensure that:
                <ul>
                    <li>You have created a media recorder object via <xref keyref="createMediaRecorder"/>.</li>
                    <li>You have registered a recorder observer via <xref keyref="setMediaRecorderObserver"/> to listen for recording-related callbacks.</li>
                    <li>You have joined a channel.</li>
                </ul><ph>This method supports recording the following data:</ph>
                <ul>
                    <li>Microphone audio in AAC format.</li>
                    <li>Camera video in H.264 or H.265 format.</li>
                </ul><ph>After recording starts, if the video resolution changes during recording, the SDK stops recording; if the audio sample rate or channel count changes, the SDK continues recording and generates a single MP4 file.</ph><ph>A recording file is generated only when recordable audio or video streams are detected. If no recordable streams are detected, or if the streams are interrupted for more than 5 seconds during recording, the SDK stops recording and triggers the <xref keyref="onRecorderStateChanged"/>(<codeph>RECORDER_STATE_ERROR, RECORDER_REASON_NO_STREAM</codeph>) callback.</ph></p>
            <note props="electron">
                <ul>
                    <li>If you need to record local audio and video streams, ensure the local user's role is set to broadcaster before starting recording.</li>
                    <li>If you need to record remote users' audio and video streams, ensure you have subscribed to those streams before starting recording.</li>
                </ul>
            </note>
            <note props="rn">
                <ul>
                    <li>If you want to record local audio and video streams, make sure the local user role is set to broadcaster before starting recording.</li>
                    <li>If you want to record remote user audio and video streams, make sure you have subscribed to the user's streams before starting recording.</li>
                </ul>
            </note>
            <note props="flutter">
                <ul>
                    <li>If you want to record local audio and video streams, ensure the local user role is set to broadcaster before starting recording.</li>
                    <li>If you want to record remote users' audio and video streams, ensure you have subscribed to those streams before starting recording.</li>
                </ul>
            </note>
            <note props="unity">
                <ul>
                    <li>If you want to record local audio and video streams, make sure the local user role is set to broadcaster before starting recording.</li>
                    <li>If you want to record remote users' audio and video streams, make sure you have subscribed to those streams before starting recording.</li>
                </ul>
            </note>
        </section>
        <section id="parameters" deliveryTarget="details" props="electron flutter rn unity">
            <title>Parameters</title>
            <parml>
                <plentry props="electron">
                    <pt>config</pt>
                    <pd>Audio and video stream recording configuration. See <xref keyref="MediaRecorderConfiguration"/>.</pd>
                </plentry>
                <plentry props="rn">
                    <pt>config</pt>
                    <pd>Audio and video stream recording configuration. See <xref keyref="MediaRecorderConfiguration"/>.</pd>
                </plentry>
                <plentry props="flutter">
                    <pt>config</pt>
                    <pd>Audio and video stream recording configuration. See <xref keyref="MediaRecorderConfiguration"/>.</pd>
                </plentry>
                <plentry props="unity">
                    <pt>config</pt>
                    <pd>Audio and video stream recording configuration. See <xref keyref="MediaRecorderConfiguration"/>.</pd>
                </plentry>
            </parml>
        </section>
        <section id="return_values" props="electron flutter rn unity">
            <title>Return Values</title>
            <p props="electron">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure. See [Error Codes](https://docs.agora.io/en/video-calling/troubleshooting/error-codes) for details and resolution suggestions.
                        <ul>
                            <li>-2: Invalid parameter. Ensure that:
                                <ul>
                                    <li>The specified recording file path is correct and writable.</li>
                                    <li>The specified recording file format is correct.</li>
                                    <li>The maximum recording duration is set correctly.</li>
                                </ul>
                            </li>
                            <li>-4: <xref keyref="IRtcEngine"/> is in a state that does not support this operation. This may occur if recording is already in progress or was stopped due to an error.</li>
                            <li>-7: <xref keyref="IRtcEngine"/> is not initialized. Ensure that the <xref keyref="IMediaRecorder"/> object is created before calling this method.</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="rn">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure. See [Error Codes](https://docs.agora.io/en/video-calling/troubleshooting/error-codes) for details and resolution suggestions.
                        <ul>
                            <li>-2: Invalid parameter. Make sure:
                                <ul>
                                    <li>The specified file save path is correct and writable.</li>
                                    <li>The specified file format is correct.</li>
                                    <li>The maximum recording duration is set correctly.</li>
                                </ul>
                            </li>
                            <li>-4: <xref keyref="IRtcEngine"/> is in a state that does not support this operation. This may be due to ongoing recording or a recording error.</li>
                            <li>-7: <xref keyref="IRtcEngine"/> is not initialized before calling this method. Make sure to create the <xref keyref="IMediaRecorder"/> object before calling this method.</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="flutter">When the method call succeeds, there is no return value; when it fails, the <xref keyref="AgoraRtcException"/> exception is thrown. You need to catch the exception and handle it accordingly. See [Error Codes](https://docs.agora.io/en/video-calling/troubleshooting/error-codes) for details and resolution suggestions.</p>
            <p props="unity">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure. See [Error Codes](https://docs.agora.io/en/video-calling/troubleshooting/error-codes) for details and resolution suggestions.
                        <ul>
                            <li>-2: Invalid parameter. Make sure:
                                <ul>
                                    <li>The specified recording file path is correct and writable.</li>
                                    <li>The specified recording file format is correct.</li>
                                    <li>The maximum recording duration is set correctly.</li>
                                </ul>
                            </li>
                            <li>-4: The current state of <xref keyref="IRtcEngine"/> does not support this operation. Possibly because recording is already in progress or has stopped due to an error.</li>
                            <li>-7: <xref keyref="IRtcEngine"/> is not initialized before calling this method. Make sure the <xref keyref="IMediaRecorder"/> object is created before calling this method.</li>
                        </ul>
                    </li>
                </ul>
            </p>
        </section>
    </refbody>
</reference>