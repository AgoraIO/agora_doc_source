<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="api_irtcengine_joinchannelwithuseraccount2">
    <title><ph keyref="joinChannelWithUserAccount2"/></title>
    <shortdesc id="short"><ph id="shortdesc" props="electron">Joins a channel using a User Account and Token, and sets channel media options.</ph><ph id="shortdesc" props="rn">Joins a channel using a User Account and Token, and sets channel media options.</ph><ph id="shortdesc" props="flutter">Joins a channel using a User Account and token, and sets channel media options.</ph><ph id="shortdesc" props="unity">Joins a channel using a User Account and Token, and sets channel media options.</ph></shortdesc>
    <prolog>
        <metadata>
            <keywords>
                <indexterm keyref="joinChannelWithUserAccount2"/>
            </keywords>
        </metadata>
    </prolog>
    <refbody>
        <section id="prototype">
            <p outputclass="codeblock">
                <codeblock props="electron" outputclass="language-typescript">abstract joinChannelWithUserAccount(
    token: string,
    channelId: string,
    userAccount: string,
    options?: ChannelMediaOptions
  ): number;</codeblock>
                <codeblock props="rn" outputclass="language-typescript">abstract joinChannelWithUserAccount(
    token: string,
    channelId: string,
    userAccount: string,
    options?: ChannelMediaOptions
  ): number;</codeblock>
                <codeblock props="flutter" outputclass="language-dart">Future&lt;void&gt; joinChannelWithUserAccount(
    {required String token,
    required String channelId,
    required String userAccount,
    ChannelMediaOptions? options});</codeblock>
                <codeblock props="unity" outputclass="language-csharp">public abstract int JoinChannelWithUserAccount(string token, string channelId, string userAccount,
            ChannelMediaOptions options);</codeblock>
            </p>
        </section>
        <section id="detailed_desc" deliveryTarget="details" otherprops="no-title">
            <p props="electron">If you do not call <xref keyref="registerLocalUserAccount"/> to register a User Account before calling this method, the SDK automatically creates a User Account for you when joining the channel. Calling <xref keyref="registerLocalUserAccount"/> to register the account before calling this method can shorten the time to join the channel.
After a user successfully joins a channel, the SDK subscribes to all audio and video streams from other users in the channel by default, which incurs usage and affects billing. If you want to unsubscribe, you can call the corresponding mute methods.</p>
            <p props="rn">If you have not called <xref keyref="registerLocalUserAccount"/> to register a User Account before calling this method, the SDK automatically creates one for you. Calling <xref keyref="registerLocalUserAccount"/> before this method can reduce the time it takes to join the channel.
After successfully joining a channel, the user subscribes to all other users' audio and video streams by default, which results in usage and affects billing. If you want to unsubscribe, you can do so by calling the corresponding mute methods.</p>
            <p props="flutter">Before calling this method, if you have not registered a User Account using <xref keyref="registerLocalUserAccount"/>, the SDK automatically creates one for you when you join a channel using this method. To reduce the time it takes to join a channel, register the account first using <xref keyref="registerLocalUserAccount"/>, then call this method.

After a user successfully joins a channel, they automatically subscribe to all audio and video streams from other users in the channel, which incurs usage and affects billing. To unsubscribe, call the corresponding mute methods.</p>
            <p props="unity">Before calling this method, if you have not called <xref keyref="registerLocalUserAccount"/> to register a User Account, the SDK automatically creates one for you when joining the channel. Calling <xref keyref="registerLocalUserAccount"/> before this method can shorten the time to join the channel.
Compared with <xref keyref="joinChannelWithUserAccount1"/>, this method adds the <codeph>options</codeph> parameter, which allows you to set media options when joining the channel, such as whether to publish audio and video streams. By default, a user subscribes to all other users' audio and video streams in the channel, which incurs usage and affects billing. If you want to unsubscribe, you can do so via the <codeph>options</codeph> parameter or corresponding mute methods.</p>
            <note props="electron">To ensure communication quality, make sure to use the same type of user identity within the same channel. That is, either UID or User Account must be used consistently. If users join the channel via the Web SDK, ensure they use the same identity type.
                <ul>
                    <li>This method only supports joining one channel at a time.</li>
                    <li>Apps with different App IDs cannot communicate with each other.</li>
                    <li>Before joining a channel, ensure that the App ID used to generate the Token is the same as the one used to initialize the engine via the <xref keyref="initialize"/> method. Otherwise, joining the channel with the Token will fail.</li>
                </ul>
            </note>
            <note props="rn">To ensure communication quality, make sure the same type of user identifier is used in the channel. That is, use either UID or User Account consistently within the same channel. If users join the channel using the Web SDK, make sure they use the same identifier type.
                <ul>
                    <li>This method only supports joining one channel at a time.</li>
                    <li>Apps with different App IDs cannot communicate with each other.</li>
                    <li>Before joining a channel, make sure the App ID used to generate the Token is the same as the one used in the <xref keyref="initialize"/> method to initialize the engine, otherwise joining the channel with the Token will fail.</li>
                </ul>
            </note>
            <note props="flutter">To ensure communication quality, make sure that all users in the channel use the same type of identifier, either UID or User Account. If users join the channel via the Web SDK, ensure they use the same identifier type.
                <ul>
                    <li>This method only supports joining one channel at a time.</li>
                    <li>Apps with different App IDs cannot communicate with each other.</li>
                    <li>Before joining a channel, make sure the App ID used to generate the token is the same as the one used in the <xref keyref="initialize"/> method. Otherwise, joining the channel with the token will fail.</li>
                </ul>
            </note>
            <note props="unity">To ensure communication quality, make sure to use the same type of user identity in the channel. That is, use either UID or User Account consistently within the same channel. If users join via the Web SDK, ensure they use the same identity type.
                <ul>
                    <li>This method only supports joining one channel at a time.</li>
                    <li>Apps with different App IDs cannot communicate with each other.</li>
                    <li>Before joining a channel, ensure the App ID used to generate the Token is the same as the one used in the <xref keyref="initialize"/> method. Otherwise, joining the channel with the Token will fail.</li>
                </ul>
            </note>
        </section>
        <section id="timing" deliveryTarget="details" props="electron flutter rn unity">
            <title>Timing</title>
            <p props="electron">This method must be called after <xref keyref="initialize"/>.</p>
            <p props="rn">You must call this method after <xref keyref="initialize"/>.</p>
            <p props="flutter">This method must be called after <xref keyref="initialize"/>.</p>
            <p props="unity">This method must be called after <xref keyref="initialize"/>.</p>
        </section>
        <section id="related" deliveryTarget="details" props="electron flutter rn unity">
            <title>Related Callbacks</title>
            <p props="electron">After successfully joining a channel, the following callbacks are triggered:
                <ul>
                    <li>Local: <xref keyref="onLocalUserRegistered"/>, <xref keyref="onJoinChannelSuccess"/>, and <xref keyref="onConnectionStateChanged"/>.</li>
                    <li>Remote: In communication scenarios, <xref keyref="onUserJoined"/> is triggered when a remote user joins; in live streaming scenarios, <xref keyref="onUserInfoUpdated"/> is triggered when a host joins.</li>
                </ul>
            </p>
            <p props="rn">After successfully joining a channel, the following callbacks are triggered:
                <ul>
                    <li>Locally: <xref keyref="onLocalUserRegistered"/>, <xref keyref="onJoinChannelSuccess"/>, and <xref keyref="onConnectionStateChanged"/> callbacks.</li>
                    <li>Remotely: In the communication profile and for hosts in the live streaming profile, the <xref keyref="onUserJoined"/> and <xref keyref="onUserInfoUpdated"/> callbacks are triggered.</li>
                </ul>
            </p>
            <p props="flutter">After successfully joining a channel, the following callbacks are triggered:
                <ul>
                    <li>Local: <xref keyref="onLocalUserRegistered"/>, <xref keyref="onJoinChannelSuccess"/>, and <xref keyref="onConnectionStateChanged"/>.</li>
                    <li>Remote: In communication scenarios, when a user joins, <xref keyref="onUserJoined"/> and <xref keyref="onUserInfoUpdated"/> are triggered on the remote end.</li>
                </ul>
            </p>
            <p props="unity">After successfully joining a channel, the following callbacks are triggered:
                <ul>
                    <li>Local: <xref keyref="onLocalUserRegistered"/>, <xref keyref="onJoinChannelSuccess"/>, and <xref keyref="onConnectionStateChanged"/>.</li>
                    <li>Remote: In communication scenarios and when a host joins in live broadcast scenarios, the remote side triggers <xref keyref="onUserJoined"/> and <xref keyref="onUserInfoUpdated"/> respectively.</li>
                </ul>
            </p>
        </section>
        <section id="parameters" deliveryTarget="details" props="electron flutter rn unity">
            <title>Parameters</title>
            <parml>
                <plentry props="electron">
                    <pt>token</pt>
                    <pd>A dynamic key generated on your server for authentication. See [Token Authentication](https://doc.shengwang.cn/doc/rtc/electron/basic-features/token-authentication).
                        <note>
                            <ul>
                                <li>(Recommended) If your project enables security mode (i.e., uses APP ID + Token for authentication), this parameter is required.</li>
                                <li>If your project only enables debug mode (i.e., uses APP ID only for authentication), you can join the channel without providing a Token. The user will automatically leave the channel after 24 hours.</li>
                                <li>If you need to join multiple channels simultaneously or switch channels frequently, Agora recommends using a wildcard Token to avoid requesting a new Token from the server for each new channel. See [Using Wildcard Token](https://doc.shengwang.cn/doc/rtc/electron/best-practice/wildcard-token).</li>
                            </ul>
                        </note>
                    </pd>
                </plentry>
                <plentry props="electron">
                    <pt>userAccount</pt>
                    <pd>The user’s User Account. This parameter identifies the user in the real-time audio and video channel. You need to set and manage the User Account yourself, and ensure that each user in the same channel has a unique User Account. This parameter is required, must not exceed 255 bytes, and cannot be null. Supported character set (89 characters total):
                        <ul>
                            <li>26 lowercase English letters a-z</li>
                            <li>26 uppercase English letters A-Z</li>
                            <li>10 digits 0-9</li>
                            <li>Space</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ","</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="electron">
                    <pt>options</pt>
                    <pd>Channel media settings. See <xref keyref="ChannelMediaOptions"/>.</pd>
                </plentry>
                <plentry props="rn">
                    <pt>token</pt>
                    <pd>A dynamic key generated on your server for authentication. See [Use Token Authentication](https://doc.shengwang.cn/doc/rtc/rn/basic-features/token-authentication).
                        <note>
                            <ul>
                                <li>(Recommended) If your project enables the security mode, i.e., uses APP ID + Token for authentication, this parameter is required.</li>
                                <li>If your project only enables debug mode, i.e., uses only the APP ID for authentication, you can join the channel without a Token. The user will automatically leave the channel 24 hours after successfully joining.</li>
                                <li>If you need to join multiple channels simultaneously or switch channels frequently, Agora recommends using a wildcard Token to avoid requesting a new Token from the server each time. See [Use Wildcard Token](https://doc.shengwang.cn/doc/rtc/rn/best-practice/wildcard-token).</li>
                            </ul>
                        </note>
                    </pd>
                </plentry>
                <plentry props="rn">
                    <pt>userAccount</pt>
                    <pd>User Account. This parameter identifies the user in the real-time audio and video interaction channel. You must set and manage the User Account yourself and ensure it is unique within the same channel. This parameter is required, must not exceed 255 bytes, and cannot be null. Supported character set (89 characters total):
                        <ul>
                            <li>26 lowercase English letters a-z</li>
                            <li>26 uppercase English letters A-Z</li>
                            <li>10 digits 0-9</li>
                            <li>Space</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ","</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="rn">
                    <pt>options</pt>
                    <pd>Channel media options. See <xref keyref="ChannelMediaOptions"/>.</pd>
                </plentry>
                <plentry props="flutter">
                    <pt>token</pt>
                    <pd>The dynamic key generated on your server for authentication. See [Use Token Authentication](https://doc.shengwang.cn/doc/rtc/flutter/basic-features/token-authentication).
                        <note>
                            <ul>
                                <li>(Recommended) If your project has enabled secure mode (using APP ID + Token for authentication), this parameter is required.</li>
                                <li>If your project is in debug mode only (using APP ID for authentication), you can join the channel without a token. The user will automatically leave the channel after 24 hours.</li>
                                <li>If you need to join multiple channels or frequently switch between channels, Agora recommends using a wildcard token to avoid requesting a new token from your server every time. See [Use Wildcard Token](https://doc.shengwang.cn/doc/rtc/flutter/best-practice/wildcard-token).</li>
                            </ul>
                        </note>
                    </pd>
                </plentry>
                <plentry props="flutter">
                    <pt>userAccount</pt>
                    <pd>The User Account of the user. This parameter identifies the user in the real-time audio/video interaction channel. You must manage and ensure the uniqueness of each User Account within the same channel. This parameter is required, must not exceed 255 bytes, and cannot be <codeph><ph keyref="NULL"/></codeph>. Supported character set (89 characters total):
                        <ul>
                            <li>26 lowercase letters a–z</li>
                            <li>26 uppercase letters A–Z</li>
                            <li>10 digits 0–9</li>
                            <li>Space</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ","</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="flutter">
                    <pt>options</pt>
                    <pd>Channel media configuration options. See <xref keyref="ChannelMediaOptions"/>.</pd>
                </plentry>
                <plentry props="unity">
                    <pt>token</pt>
                    <pd>A dynamic key generated on your server for authentication. See [Token Authentication](https://doc.shengwang.cn/doc/rtc/unity/basic-features/token-authentication).
                        <note>
                            <ul>
                                <li>(Recommended) If your project enables security mode (i.e., uses APP ID + Token for authentication), this parameter is required.</li>
                                <li>If your project is in debug mode only (i.e., uses APP ID for authentication), you can join the channel without a Token. You will automatically leave the channel after 24 hours.</li>
                                <li>If you need to join multiple channels or switch between them frequently, Agora recommends using a wildcard Token to avoid requesting a new Token from your server each time. See [Using Wildcard Token](https://doc.shengwang.cn/doc/rtc/unity/best-practice/wildcard-token).</li>
                            </ul>
                        </note>
                    </pd>
                </plentry>
                <plentry props="unity">
                    <pt>userAccount</pt>
                    <pd>The User Account of the user. This parameter identifies the user in the real-time audio and video interaction channel. You need to set and manage the User Account yourself and ensure each user in the same channel has a unique User Account. This parameter is required. Maximum length is 255 bytes and cannot be <codeph><ph keyref="NULL"/></codeph>. Supported character set (89 characters total):
                        <ul>
                            <li>26 lowercase English letters a-z</li>
                            <li>26 uppercase English letters A-Z</li>
                            <li>10 digits 0-9</li>
                            <li>Space</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ","</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="unity">
                    <pt>options</pt>
                    <pd>Channel media configuration options. See <xref keyref="ChannelMediaOptions"/>.</pd>
                </plentry>
            </parml>
        </section>
        <section id="return_values" props="electron flutter rn unity">
            <title>Return Values</title>
            <p props="electron">
                <ul>
                    <li>0: The method call succeeds.</li>
                    <li>&lt; 0: The method call fails. See [Error Codes](https://docs.agora.io/en/video-calling/troubleshooting/error-codes) for details and resolution suggestions.
                        <ul>
                            <li>-2: Invalid parameter. For example, an invalid Token, non-integer <codeph>uid</codeph>, or invalid <xref keyref="ChannelMediaOptions"/> member value. Provide valid parameters and rejoin the channel.</li>
                            <li>-3: <xref keyref="IRtcEngine"/> object initialization failed. Re-initialize the <xref keyref="IRtcEngine"/> object.</li>
                            <li>-7: <xref keyref="IRtcEngine"/> object not initialized. You need to initialize the <xref keyref="IRtcEngine"/> object before calling this method.</li>
                            <li>-8: Internal state error of <xref keyref="IRtcEngine"/> object. Possible reason: <xref keyref="startEchoTest3"/> was called to start the echo test but <xref keyref="stopEchoTest"/> was not called before joining the channel. Call <xref keyref="stopEchoTest"/> before this method.</li>
                            <li>-17: Join channel request rejected. Possible reason: the user is already in the channel. Use the <xref keyref="onConnectionStateChanged"/> callback to check if the user is in the channel. Do not call this method again unless the state is <codeph>ConnectionStateDisconnected</codeph>(1).</li>
                            <li>-102: Invalid channel name. Provide a valid channel name in <codeph>channelId</codeph> and rejoin the channel.</li>
                            <li>-121: Invalid user ID. Provide a valid user ID in <codeph>uid</codeph> and rejoin the channel.</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="rn">
                <ul>
                    <li>0: The method call succeeds.</li>
                    <li>&lt; 0: The method call fails. See [Error Codes](https://docs.agora.io/en/video-calling/troubleshooting/error-codes) for details and resolution suggestions.
                        <ul>
                            <li>-2: Invalid parameter. For example, an invalid Token is used, <codeph>uid</codeph> is not an integer, or a <xref keyref="ChannelMediaOptions"/> member is invalid. You need to provide valid parameters and rejoin the channel.</li>
                            <li>-3: <xref keyref="IRtcEngine"/> object initialization failed. You need to reinitialize the <xref keyref="IRtcEngine"/> object.</li>
                            <li>-7: <xref keyref="IRtcEngine"/> object is not initialized. You must initialize the <xref keyref="IRtcEngine"/> object before calling this method.</li>
                            <li>-8: Internal state error of the <xref keyref="IRtcEngine"/> object. Possible reason: <xref keyref="startEchoTest3"/> was called to start an echo test, but <xref keyref="stopEchoTest"/> was not called before calling this method. You must call <xref keyref="stopEchoTest"/> before this method.</li>
                            <li>-17: Join channel request is rejected. Possible reason: the user is already in the channel. Use the <xref keyref="onConnectionStateChanged"/> callback to check if the user is in the channel. Do not call this method again unless you receive the <codeph>ConnectionStateDisconnected</codeph>(1) state.</li>
                            <li>-102: Invalid channel name. You must provide a valid channel name in <codeph>channelId</codeph> and rejoin the channel.</li>
                            <li>-121: Invalid user ID. You must provide a valid user ID in <codeph>uid</codeph> and rejoin the channel.</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="flutter">When the method call succeeds, there is no return value; when it fails, the <xref keyref="AgoraRtcException"/> exception is thrown. You need to catch the exception and handle it accordingly. See [Error Codes](https://docs.agora.io/en/video-calling/troubleshooting/error-codes) for details and resolution suggestions.
                <ul>
                    <li>&lt; 0: The method call fails. See [Error Codes](https://docs.agora.io/en/video-calling/troubleshooting/error-codes) for details and resolution suggestions.
                        <ul>
                            <li>-2: Invalid parameter. For example, an illegal token is used, the <codeph>uid</codeph> parameter is not an integer, or a member value of <xref keyref="ChannelMediaOptions"/> is invalid. Provide valid parameters and rejoin the channel.</li>
                            <li>-3: <xref keyref="IRtcEngine"/> initialization failed. Reinitialize the <xref keyref="IRtcEngine"/> object.</li>
                            <li>-7: <xref keyref="IRtcEngine"/> not initialized. Initialize <xref keyref="IRtcEngine"/> before calling this method.</li>
                            <li>-8: Internal state error of <xref keyref="IRtcEngine"/>. This may occur if you call this method after starting an echo test with <xref keyref="startEchoTest3"/> but before stopping it with <xref keyref="stopEchoTest"/>. Call <xref keyref="stopEchoTest"/> before this method.</li>
                            <li>-17: Join channel rejected. Possibly because the user is already in the channel. Use the <xref keyref="onConnectionStateChanged"/> callback to check if the user is in the channel. Do not call this method again unless the state is <codeph>connectionStateDisconnected</codeph> (1).</li>
                            <li>-102: Invalid channel name. Provide a valid <codeph>channelId</codeph> and rejoin the channel.</li>
                            <li>-121: Invalid user ID. Provide a valid <codeph>uid</codeph> and rejoin the channel.</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="unity">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure. See [Error Codes](https://docs.agora.io/en/video-calling/troubleshooting/error-codes) for details and suggestions.
                        <ul>
                            <li>-2: Invalid parameter. For example, an invalid Token, <codeph>uid</codeph> is not an integer, or <xref keyref="ChannelMediaOptions"/> contains invalid values. Provide valid parameters and rejoin the channel.</li>
                            <li>-3: <xref keyref="IRtcEngine"/> initialization failed. Reinitialize the <xref keyref="IRtcEngine"/> object.</li>
                            <li>-7: <xref keyref="IRtcEngine"/> not initialized. Initialize it before calling this method.</li>
                            <li>-8: Internal state error of <xref keyref="IRtcEngine"/>. Possible cause: calling this method after <xref keyref="startEchoTest3"/> without calling <xref keyref="stopEchoTest"/>. Call <xref keyref="stopEchoTest"/> before this method.</li>
                            <li>-17: Join channel request rejected. Possible cause: user already in channel. Use <xref keyref="onConnectionStateChanged"/> to check. Do not call this method again unless receiving <codeph>CONNECTION_STATE_DISCONNECTED</codeph>(1).</li>
                            <li>-102: Invalid channel name. Provide a valid channel name in <codeph>channelId</codeph> and rejoin.</li>
                            <li>-121: Invalid user ID. Provide a valid UID and rejoin.</li>
                        </ul>
                    </li>
                </ul>
            </p>
        </section>
    </refbody>
</reference>