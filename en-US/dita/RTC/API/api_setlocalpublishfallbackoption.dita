<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="api_setlocalpublishfallbackoption">
    <title><ph keyref="setLocalPublishFallbackOption"/></title>
    <shortdesc id="short"><ph id="shortdesc">Sets the fallback option for the published video stream based on the network conditions.</ph></shortdesc>
    <prolog>
        <metadata>
   <keywords>
       <indexterm keyref="setLocalPublishFallbackOption" />
   </keywords>
        </metadata>
    </prolog>
    <refbody><section id="prototype">
        <p outputclass="codeblock">
                <codeblock props="android" outputclass="language-java"/>
                <codeblock props="ios mac" outputclass="language-objectivec"/>
                <codeblock props="windows" outputclass="language-cpp">virtual int setLocalPublishFallbackOption(STREAM_FALLBACK_OPTIONS option) = 0;</codeblock>
                <codeblock props="electron" outputclass="language-typescript">setLocalPublishFallbackOption(option: STREAM_FALLBACK_OPTIONS): number</codeblock>
                <codeblock props="unity" outputclass="language-csharp"/>
                <codeblock props="rn" outputclass="language-typescript"/>
                <codeblock props="flutter" outputclass="language-dart"/>
        </p>
        </section>
        <section id="detailed_desc">
   
   <p>An unstable network affects the audio and video quality in a video call or interactive live video streaming. If <parmname>option</parmname> is set as<apiname keyref="STREAM_FALLBACK_OPTION_AUDIO_ONLY"/> (2), the SDK disables the upstream video but enables audio only when the network conditions deteriorate and cannot support both video and audio. The SDK monitors the network quality and restores the video stream when the network conditions improve. When the published video stream falls back to audio only or when the audio-only stream switches back to the video, the SDK triggers the callback<xref keyref="onLocalPublishFallbackToAudioOnly"/>.</p>
   <note type="attention">
       <ul>
  <li>旁路推流场景下，设置本地推流回退为 <apiname keyref="STREAM_FALLBACK_OPTION_AUDIO_ONLY"/>(2) 可能会导致远端的 CDN 用户听到声音的时间有所延迟。 因此在有旁路推流的场景下，Agora 建议不开启该功能。</li>
  <li>Ensure that you call this method before joining a channel.</li>
       </ul>
   </note>
        </section>
        <section id="parameters"><title>Parameter</title>
   <parml>
       <plentry>
  <pt>option</pt>
  <pd>The stream fallback option.<ul>
 <li><apiname keyref="STREAM_FALLBACK_OPTION_DISABLED"/> (0): (Default) No fallback behavior for the published video stream when the uplink network condition is poor. The stream quality is not guaranteed.</li>
 <li><apiname keyref="STREAM_FALLBACK_OPTION_AUDIO_ONLY"/> (2): The published video stream falls back to audio only when the uplink network condition is poor.</li>
      </ul>
  </pd>
       </plentry>
   </parml>
        </section>
        <section id="return_values">
   <title>Returns</title>
   <ul>
       <li>0: Success.</li>
       <li>&lt; 0: Failure.</li>
   </ul>
        </section></refbody>
</reference>
