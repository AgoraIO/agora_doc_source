<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="callback_irtcengineeventhandler_onuseroffline">
    <title><ph keyref="onUserOffline"/></title>
    <shortdesc id="short"><ph id="shortdesc" props="cpp"><xref keyref="onUserOffline"/> callback: Triggered when a remote user (communication channel) or host (live broadcast channel) leaves the channel.</ph><ph id="shortdesc" props="android">Callback triggered when a remote user or host leaves the channel.</ph></shortdesc>
    <prolog>
        <metadata>
            <keywords>
                <indexterm keyref="onUserOffline"/>
            </keywords>
        </metadata>
    </prolog>
    <refbody>
        <section id="prototype">
            <p outputclass="codeblock">
                <codeblock props="cpp" outputclass="language-cpp">virtual void onUserOffline(uid_t uid, USER_OFFLINE_REASON_TYPE reason)</codeblock>
                <codeblock props="android" outputclass="language-java">public void onUserOffline(int uid, int reason)</codeblock>
            </p>
        </section>
        <section id="detailed_desc" deliveryTarget="details" otherprops="no-title">
            <p props="cpp">A user going offline usually occurs in the following two scenarios:
                <ul>
                    <li>Leaves the channel: When the user or host actively leaves the channel, a leave message is sent.</li>
                    <li>Drops offline: If no data packet is received from the user or host for a period of time, the SDK considers them offline. The timeout is 20 seconds in communication channels and longer in live broadcast channels. Poor network conditions may cause <codeph><ph keyref="false"/></codeph> positives. It is recommended to use the Agora RTM SDK for more reliable offline detection.</li>
                </ul>
            </p>
            <p props="android">A user going offline is typically due to one of the following reasons:
                <ul>
                    <li>Leaving the channel: When the user or host leaves the channel, a leave message is sent.</li>
                    <li>Dropped: If no data packet is received from the user or host for a period of time (20 seconds in a channel scenario, longer in a live streaming scenario), the SDK considers them dropped. Poor network conditions may cause misjudgment. It is recommended to use the Agora RTM SDK for reliable offline detection.</li>
                </ul>
            </p>
        </section>
        <section id="timing" deliveryTarget="details" props="android cpp">
            <title>Trigger Timing</title>
            <p props="cpp">This callback is triggered when a remote user (communication channel) or host (live broadcast channel) leaves the channel.</p>
            <p props="android">This callback is triggered when a remote user (in a channel scenario) or host (in a live streaming scenario) leaves the channel.</p>
        </section>
        <section id="parameters" deliveryTarget="details" props="android cpp">
            <title>Parameters</title>
            <parml>
                <plentry props="cpp">
                    <pt>uid</pt>
                    <pd>The user ID of the user who left the channel or went offline.</pd>
                </plentry>
                <plentry props="cpp">
                    <pt>reason</pt>
                    <pd>The reason why the user went offline. See <xref keyref="USER_OFFLINE_REASON_TYPE"/>.</pd>
                </plentry>
                <plentry props="android">
                    <pt>uid</pt>
                    <pd>The user ID of the user who left the channel or went offline.</pd>
                </plentry>
                <plentry props="android">
                    <pt>reason</pt>
                    <pd>The reason why the remote user (in a channel scenario) or host (in a live streaming scenario) went offline:
                        <ul>
                            <li><codeph>USER_OFFLINE_QUIT</codeph> (0): The user voluntarily left the call and sent a leave message.</li>
                            <li><codeph>USER_OFFLINE_DROPPED</codeph> (1): The SDK timed out without receiving any data packets, and the user was considered dropped. Poor network conditions may cause misjudgment. It is recommended to use the Agora RTM SDK for reliable offline detection.</li>
                            <li><codeph>USER_OFFLINE_BECOME_AUDIENCE</codeph> (2): The user switched their role from host to audience.</li>
                        </ul>
                    </pd>
                </plentry>
            </parml>
        </section>
    </refbody>
</reference>