<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="api_irtcengine_joinchannelwithuseraccount1">
    <title><ph keyref="joinChannelWithUserAccount1"/></title>
    <shortdesc id="short"><ph id="shortdesc" props="cpp">Joins a channel using a user account and token.</ph><ph id="shortdesc" props="android">Joins a channel using a user account and token.</ph></shortdesc>
    <prolog>
        <metadata>
            <keywords>
                <indexterm keyref="joinChannelWithUserAccount1"/>
            </keywords>
        </metadata>
    </prolog>
    <refbody>
        <section id="prototype">
            <p outputclass="codeblock">
                <codeblock props="cpp" outputclass="language-cpp">virtual int joinChannelWithUserAccount(const char* token, const char* channelId, const char* userAccount) = 0;</codeblock>
                <codeblock props="android" outputclass="language-java">public abstract int joinChannelWithUserAccount(String token, String channelName, String userAccount);</codeblock>
            </p>
        </section>
        <section id="detailed_desc" deliveryTarget="details" otherprops="no-title">
            <p props="cpp">Before calling this method, if you have not yet called <xref keyref="registerLocalUserAccount"/> to register a user account, the SDK automatically creates one for you when you call this method to join a channel. It is recommended to call <xref keyref="registerLocalUserAccount"/> first and then use this method to join a channel to reduce the time required to join.

After a user joins a channel, they subscribe to all other users' audio and video streams by default, which generates usage and billing. To stop subscribing to specific or all remote streams, call <codeph>setRemoteAudio/VideoStream</codeph> or <codeph>setAllRemoteAudio/VideoStreams</codeph>.</p>
            <p props="android">Calling <xref keyref="registerLocalUserAccount"/> to register a user account before calling this method to join a channel may reduce the time required to join. If you have not called <xref keyref="registerLocalUserAccount"/>, the SDK automatically creates a user account when you call this method to join a channel.
Once a user joins a channel, by default they subscribe to all other users’ audio and video streams, which generates usage and billing. To stop subscribing to specific or all remote streams, call <codeph>muteRemoteAudio/VideoStream</codeph> or <codeph>muteAllRemoteAudio/VideoStreams</codeph>.</p>
            <note props="cpp">
                <ul>
                    <li>This method only supports joining one channel at a time.</li>
                    <li>Users with different App IDs cannot communicate with each other.</li>
                    <li>Before joining a channel, ensure that the App ID used to generate the token matches the App ID passed in the <xref keyref="initialize"/> method, otherwise joining the channel may fail.</li>
                    <li>To ensure smooth communication, use the same parameter type to identify users. For example, if one user joins with a user ID, others should also use user IDs; if joining with a user account, others should also use user accounts. If users join the channel using the Agora Web SDK, ensure that the user ID type is consistent.</li>
                </ul>
            </note>
            <note props="android">
                <ul>
                    <li>This method only supports joining one channel at a time.</li>
                    <li>Users with different App IDs cannot communicate with each other.</li>
                    <li>Before joining a channel, ensure the App ID used to generate the token matches the App ID passed in the <xref keyref="initialize"/> method; otherwise, joining the channel with the token may fail.</li>
                    <li>To ensure smooth communication, use the same parameter type to identify users. For example, if one user joins using <codeph>uid</codeph>, other users should also use <codeph>uid</codeph>; if using a user account, others should also use a user account. If a user joins using the Agora Web SDK, ensure the user ID uses the same parameter type.</li>
                </ul>
            </note>
        </section>
        <section id="timing" deliveryTarget="details" props="android cpp">
            <title>Timing</title>
            <p props="cpp">Call this method after calling <xref keyref="initialize"/>.</p>
            <p props="android">Call this method after calling the <xref keyref="initialize"/> method.</p>
        </section>
        <section id="related" deliveryTarget="details" props="android cpp">
            <title>Related Callbacks</title>
            <p props="cpp">After successfully calling this method, the SDK triggers the following callbacks:
                <ul>
                    <li>Local client: <xref keyref="onLocalUserRegistered"/>, <xref keyref="onJoinChannelSuccess"/>, and <xref keyref="onConnectionStateChanged"/>.</li>
                    <li>Remote clients: If the user joins a channel in the <codeph>COMMUNICATION</codeph> profile or as a broadcaster in the <codeph>LIVE_BROADCASTING</codeph> profile, the <xref keyref="onUserJoined"/> and <xref keyref="onUserInfoUpdated"/> callbacks are triggered.</li>
                </ul>
            </p>
            <p props="android">Local client: <xref keyref="onLocalUserRegistered"/>, <xref keyref="onJoinChannelSuccess"/>, and <xref keyref="onConnectionStateChanged"/> callbacks.
Remote client: If a user joins a channel in the <codeph>COMMUNICATION</codeph> profile or a host joins a channel in the <codeph>LIVE_BROADCASTING</codeph> profile, the <xref keyref="onUserJoined"/> and <xref keyref="onUserInfoUpdated"/> callbacks are triggered.</p>
        </section>
        <section id="parameters" deliveryTarget="details" props="android cpp">
            <title>Parameters</title>
            <parml>
                <plentry props="cpp">
                    <pt>token</pt>
                    <pd>The token generated on your server for authentication.
                        <note>
                            <ul>
                                <li>(Recommended) If your project enables security mode (authentication using App ID and token), this parameter is required.</li>
                                <li>If you enable only testing mode (authentication using App ID), this parameter is optional. After successfully joining the channel, you will be automatically disconnected after 24 hours.</li>
                                <li>If you need to join multiple channels simultaneously or switch between channels, Agora recommends using a wildcard token so you do not need to request a new token each time you join a channel.</li>
                            </ul>
                        </note>
                    </pd>
                </plentry>
                <plentry props="cpp">
                    <pt>channelId</pt>
                    <pd>The channel name. Users with the same App ID and channel name join the same channel for audio and video interaction. The string length must be less than 64 bytes. Supported characters (89 total):
                        <ul>
                            <li>All lowercase English letters: a to z.</li>
                            <li>All uppercase English letters: A to Z.</li>
                            <li>All numeric digits: 0 to 9.</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ","</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="cpp">
                    <pt>userAccount</pt>
                    <pd>The user account. You need to set and manage the user account yourself and ensure that each user account is unique within the same channel. The maximum length of this parameter is 255 bytes and it cannot be empty. Supported characters (89 total):
                        <ul>
                            <li>26 lowercase English letters: a to z.</li>
                            <li>26 uppercase English letters: A to Z.</li>
                            <li>All numeric digits: 0 to 9.</li>
                            <li>Space</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ","</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>token</pt>
                    <pd>The token generated on your server for authentication.
                        <note>
                            <ul>
                                <li>(Recommended) If your project has enabled secure mode (authentication using App ID and Token), this parameter is required.</li>
                                <li>If only test mode is enabled (authentication using App ID), this parameter is optional. After successfully joining the channel, you will automatically leave the channel after 24 hours.</li>
                                <li>If you need to join different channels or switch between them, Agora recommends using a wildcard token so you don’t need to request a new token each time.</li>
                            </ul>
                        </note>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>channelName</pt>
                    <pd>Channel name. Users with the same App ID who enter the same channel name will join the same channel for audio and video interaction. The string length must be less than 64 bytes. Supported characters (total 89):
                        <ul>
                            <li>All lowercase letters: a to z.</li>
                            <li>All uppercase letters: A to Z.</li>
                            <li>All numeric characters: 0 to 9.</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ","</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>userAccount</pt>
                    <pd>The user account used to identify the user in the channel for real-time audio and video interaction. You must set and manage this account yourself and ensure it is unique within the same channel. The maximum length of this parameter is 255 bytes and it cannot be empty. Supported characters (total 89):
                        <ul>
                            <li>26 lowercase letters: a to z.</li>
                            <li>26 uppercase letters: A to Z.</li>
                            <li>All numeric characters: 0 to 9.</li>
                            <li>Space</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ","</li>
                        </ul>
                    </pd>
                </plentry>
            </parml>
        </section>
        <section id="return_values" props="android cpp">
            <title>Return Values</title>
            <p props="cpp">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure.
                        <ul>
                            <li>-2: Invalid parameter. For example, the token is invalid, the <codeph>uid</codeph> parameter is not set to an integer, or a member of <xref keyref="ChannelMediaOptions"/> has an invalid value. Pass in valid parameters and rejoin the channel.</li>
                            <li>-3: <xref keyref="IRtcEngine"/> object initialization failed. Reinitialize the <xref keyref="IRtcEngine"/> object.</li>
                            <li>-7: <xref keyref="IRtcEngine"/> object not initialized. Initialize the <xref keyref="IRtcEngine"/> object before calling this method.</li>
                            <li>-8: Internal state error of the <xref keyref="IRtcEngine"/> object. A common cause is calling this method to join a channel after calling <xref keyref="startEchoTest3"/> to start an echo test without calling <xref keyref="stopEchoTest"/> to stop it. Call <xref keyref="stopEchoTest"/> before calling this method.</li>
                            <li>-17: Join channel request rejected. A common cause is the user is already in the channel. Agora recommends checking the user's connection status using the <xref keyref="onConnectionStateChanged"/> callback and only calling this method when receiving the <codeph>CONNECTION_STATE_DISCONNECTED</codeph> (1) state.</li>
                            <li>-102: Invalid channel name. Pass a valid channel name in <codeph>channelId</codeph> and rejoin the channel.</li>
                            <li>-121: Invalid user ID. Pass a valid user ID in <codeph>uid</codeph> and rejoin the channel.</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="android">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure.
                        <ul>
                            <li>-2: Invalid parameter. For example, the token is invalid, the <codeph>uid</codeph> is not set as an integer, or a member value in <xref keyref="ChannelMediaOptions"/> is invalid. Pass in valid parameters and rejoin the channel.</li>
                            <li>-3: <xref keyref="IRtcEngine"/> object initialization failed. Reinitialize the <xref keyref="IRtcEngine"/> object.</li>
                            <li>-7: <xref keyref="IRtcEngine"/> object is not initialized. Initialize the <xref keyref="IRtcEngine"/> object before calling this method.</li>
                            <li>-8: Internal state error of the <xref keyref="IRtcEngine"/> object. A typical cause is calling this method to join a channel after starting an echo test with <xref keyref="startEchoTest3"/> without stopping it using <xref keyref="stopEchoTest"/>. Call <xref keyref="stopEchoTest"/> before calling this method.</li>
                            <li>-17: Join channel request is rejected. A typical cause is the user is already in a channel. Agora recommends using the <xref keyref="onConnectionStateChanged"/> callback to determine whether the user is in a channel. Only call this method when receiving the <codeph>CONNECTION_STATE_DISCONNECTED</codeph> (1) state.</li>
                            <li>-102: Invalid channel name. Pass a valid channel name in <codeph>channelId</codeph> to rejoin the channel.</li>
                            <li>-121: Invalid user ID. Pass a valid user ID in <codeph>uid</codeph> to rejoin the channel.</li>
                        </ul>
                    </li>
                </ul>
            </p>
        </section>
    </refbody>
</reference>