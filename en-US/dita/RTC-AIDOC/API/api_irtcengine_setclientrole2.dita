<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="api_irtcengine_setclientrole2">
    <title><ph keyref="setClientRole2"/></title>
    <shortdesc id="short"><ph id="shortdesc" props="cpp">Sets the user role and audience latency level.</ph><ph id="shortdesc" props="android">Sets the user role and audience latency level in live streaming.</ph></shortdesc>
    <prolog>
        <metadata>
            <keywords>
                <indexterm keyref="setClientRole2"/>
            </keywords>
        </metadata>
    </prolog>
    <refbody>
        <section id="prototype">
            <p outputclass="codeblock">
                <codeblock props="cpp" outputclass="language-cpp">virtual int setClientRole(CLIENT_ROLE_TYPE role, const ClientRoleOptions&amp; options) = 0;</codeblock>
                <codeblock props="android" outputclass="language-java">public abstract int setClientRole(int role, ClientRoleOptions options);</codeblock>
            </p>
        </section>
        <section id="detailed_desc" deliveryTarget="details" otherprops="no-title">
            <p props="cpp">This method sets the user role and audience latency level. You can call this method to set the user role to broadcaster. The <codeph>role</codeph> parameter determines the user's privileges at the SDK level, such as whether the user can publish audio and video streams in the channel.
Compared to <codeph>setClientRole</codeph>, this method supports setting <codeph>audienceLatencyLevel</codeph>. You must use <codeph>audienceLatencyLevel</codeph> together with <codeph>role</codeph> to determine the service level the user can access within their privileges. For example, audience users can choose to receive low-latency or ultra-low-latency remote streams.
                <ul>
                    <li>If you call this method before joining a channel and set the user role to broadcaster, and configure local video properties using <xref keyref="setupLocalVideo"/>, the local video preview automatically starts when the user joins the channel.</li>
                    <li>If you call this method to change the user role after joining a channel, the SDK automatically calls <xref keyref="muteLocalAudioStream"/> and <xref keyref="muteLocalVideoStream"/> to change the publishing state of the audio and video streams.</li>
                </ul>
            </p>
            <p props="android">By default, the SDK sets the user role to audience. You can call this method to set the role to broadcaster. The <codeph>role</codeph> determines the user's privileges at the SDK level, including whether the user can publish audio and video streams in the channel.
This method differs from <codeph>setClientRole(int role)</codeph> in that it supports setting <codeph>audienceLatencyLevel</codeph>. <codeph>audienceLatencyLevel</codeph> must be used together with <codeph>role</codeph> to determine the service level available to the user. For example, audience users can choose to receive low or ultra-low latency streams.</p>
            <note props="cpp">When the user role is set to broadcaster, the audience latency level can only be set to <codeph>AUDIENCE_LATENCY_LEVEL_ULTRA_LOW_LATENCY</codeph>.
If you call this method before joining a channel and set <codeph>role</codeph> to <codeph>BROADCASTER</codeph>, the local client does not trigger the <xref keyref="onClientRoleChanged"/> callback.
If you call this method before joining a channel and set <codeph>role</codeph> to <codeph>AUDIENCE</codeph>, the callback is triggered.</note>
            <note props="android">When the user role is set to broadcaster, the audience latency level must be <codeph>AUDIENCE_LATENCY_LEVEL_ULTRA_LOW_LATENCY</codeph>.
If you call this method before joining a channel and set <codeph>role</codeph> to <codeph>BROADCASTER</codeph>, the local client does not trigger the <xref keyref="onClientRoleChanged"/> callback.
If you call this method before joining a channel and set <codeph>role</codeph> to <codeph>AUDIENCE</codeph>, the callback is triggered.</note>
        </section>
        <section id="timing" deliveryTarget="details" props="android cpp">
            <title>Timing</title>
            <p props="cpp">You can call this method before or after joining a channel.</p>
            <p props="android">You can call this method before or after joining a channel.
                <ul>
                    <li>If you call this method before joining a channel and use <xref keyref="setupLocalVideo"/> to configure local video, the local video preview starts automatically when the user joins the channel.</li>
                    <li>If you call this method after joining a channel, the SDK automatically calls <xref keyref="muteLocalAudioStream"/> and <xref keyref="muteLocalVideoStream"/> to change the publishing state of audio and video streams.</li>
                </ul>
            </p>
        </section>
        <section id="related" deliveryTarget="details" props="android cpp">
            <title>Related Callbacks</title>
            <p props="cpp">If you call this method to switch the user role after joining a channel, the SDK triggers the following callbacks:
                <ul>
                    <li>The local client receives the <xref keyref="onClientRoleChanged"/> callback. Note: Calling this method before joining a channel and setting <codeph>role</codeph> to <codeph>AUDIENCE</codeph> also triggers this callback.</li>
                    <li>The remote client receives the <xref keyref="onUserJoined"/> or <xref keyref="onUserOffline"/> callback.</li>
                </ul><ph>If the method call to set the user role fails after joining a channel, the SDK triggers the <xref keyref="onClientRoleChangeFailed"/> callback to report the failure reason and the current user role.</ph></p>
            <p props="android">If you call this method to switch the user role after joining a channel, the SDK triggers the following callbacks:
                <ul>
                    <li>The local client: <xref keyref="onClientRoleChanged"/> callback. Note: This callback is also triggered if you call this method before joining a channel and set <codeph>role</codeph> to <codeph>AUDIENCE</codeph>.</li>
                    <li>Remote clients: <xref keyref="onUserJoined"/> or <xref keyref="onUserOffline"/> callback.</li>
                </ul><ph>If the method call fails, the SDK triggers the <xref keyref="onClientRoleChangeFailed"/> callback, reporting the failure reason and current role.</ph></p>
        </section>
        <section id="parameters" deliveryTarget="details" props="android cpp">
            <title>Parameters</title>
            <parml>
                <plentry props="cpp">
                    <pt>role</pt>
                    <pd>The user role. See <xref keyref="CLIENT_ROLE_TYPE"/>.
                        <note>If you set the user role to audience, the user cannot publish audio or video streams in the channel. If you want to publish media streams in a live broadcast, make sure to set the user role to broadcaster.</note>
                    </pd>
                </plentry>
                <plentry props="cpp">
                    <pt>options</pt>
                    <pd>Detailed user options. See <xref keyref="ClientRoleOptions"/>.</pd>
                </plentry>
                <plentry props="android">
                    <pt>role</pt>
                    <pd>
                        <note>If you set the user role to audience, you cannot publish audio or video streams in the channel. If you want to publish media streams during live streaming, make sure to set the role to broadcaster.</note><ph>User role.</ph>
                        <ul>
                            <li><codeph>CLIENT_ROLE_BROADCASTER</codeph> (1): Broadcaster.</li>
                            <li><codeph>CLIENT_ROLE_AUDIENCE</codeph> (2): Audience (default).</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>options</pt>
                    <pd>Detailed user options. See <xref keyref="ClientRoleOptions"/>.</pd>
                </plentry>
            </parml>
        </section>
        <section id="return_values" props="android cpp">
            <title>Return Values</title>
            <p props="cpp">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure.
                        <ul>
                            <li>-1: A general error occurs (no specific reason).</li>
                            <li>-2: Invalid parameter.</li>
                            <li>-5: The request is rejected.</li>
                            <li>-7: The SDK is not initialized.</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="android">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure.
                        <ul>
                            <li>-1: A general error occurred (no specific reason).</li>
                            <li>-2: Invalid parameter.</li>
                            <li>-5: Request rejected.</li>
                            <li>-7: SDK not initialized.</li>
                        </ul>
                    </li>
                </ul>
            </p>
        </section>
    </refbody>
</reference>