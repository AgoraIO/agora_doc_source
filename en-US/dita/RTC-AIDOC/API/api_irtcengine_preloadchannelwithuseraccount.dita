<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="api_irtcengine_preloadchannelwithuseraccount">
    <title><ph keyref="preloadChannelWithUserAccount"/></title>
    <shortdesc id="short"><ph id="shortdesc" props="cpp">Preloads the specified channel.</ph><ph id="shortdesc" props="android">Preloads the specified channel to reduce the time it takes for a viewer to join the channel.</ph></shortdesc>
    <prolog>
        <metadata>
            <keywords>
                <indexterm keyref="preloadChannelWithUserAccount"/>
            </keywords>
        </metadata>
    </prolog>
    <refbody>
        <section id="prototype">
            <p outputclass="codeblock">
                <codeblock props="cpp" outputclass="language-cpp">virtual int preloadChannelWithUserAccount(const char* token, const char* channelId, const char* userAccount) = 0;</codeblock>
                <codeblock props="android" outputclass="language-java">public abstract int preloadChannelWithUserAccount(String token, String channelName, String userAccount);</codeblock>
            </p>
        </section>
        <section id="detailed_desc" deliveryTarget="details" otherprops="no-title">
            <p props="cpp">When audience users frequently switch between different channels, calling this method can reduce the time it takes to join a channel, thereby reducing the delay in hearing or seeing the host. If you join a preloaded channel, leave it, and want to rejoin it, you do not need to call this method again unless the Token used for preloading has expired.</p>
            <p props="android">When viewers need to switch between different channels frequently, calling this method can reduce the time to join a channel, thereby reducing the delay in hearing and seeing the host. If you rejoin a preloaded channel after leaving it, you do not need to call this method again unless the token used for preloading has expired.</p>
            <note props="cpp">
                <ul>
                    <li>When calling this method, ensure the user role is set to audience and the audio scenario is not set to <codeph>AUDIO_SCENARIO_CHORUS</codeph>, otherwise this method will not take effect.</li>
                    <li>Also ensure that the user account, channel name, and Token used for preloading are the same as those used when joining the channel, otherwise this method will not take effect.</li>
                    <li>One <xref keyref="IRtcEngine"/> instance supports up to 20 preloaded channels. If this limit is exceeded, only the latest 20 preloaded channels take effect.</li>
                    <li>Failing to preload a channel does not affect the ability to join the channel or increase the time needed to join.</li>
                </ul>
            </note>
            <note props="android">
                <ul>
                    <li>When calling this method, ensure the user role is set to audience and the audio scenario is not set to <codeph>AUDIO_SCENARIO_CHORUS</codeph>, otherwise this method will not take effect.</li>
                    <li>You must ensure that the User Account, channel name, and token used for preloading are the same as those used when joining the channel, otherwise the method will not take effect.</li>
                    <li>A single <xref keyref="IRtcEngine"/> instance supports preloading up to 20 channels. If this limit is exceeded, only the most recent 20 preloaded channels take effect.</li>
                    <li>Failing to preload a channel does not affect the ability to join the channel, nor does it increase the time required to join the channel.</li>
                </ul>
            </note>
        </section>
        <section id="timing" deliveryTarget="details" props="android cpp">
            <title>Timing</title>
            <p props="cpp">To improve the user experience of channel preloading, Agora recommends calling this method as early as possible after confirming the channel name and user information.</p>
            <p props="android">To enhance the user experience of preloading channels, Agora recommends calling this method as early as possible after confirming the channel name and user information.</p>
        </section>
        <section id="parameters" deliveryTarget="details" props="android cpp">
            <title>Parameters</title>
            <parml>
                <plentry props="cpp">
                    <pt>token</pt>
                    <pd>The Token used for authentication, generated by your server. When the Token expires, you can update it based on the number of preloaded channels:
                        <ul>
                            <li>To preload one channel, call this method with the new Token.</li>
                            <li>To preload multiple channels:
                                <ul>
                                    <li>If you use a wildcard Token for all preloaded channels, call <xref keyref="updatePreloadChannelToken"/> to update the Token. Note: Ensure the user ID is not 0 when generating the wildcard Token.</li>
                                    <li>If you use different Tokens for different channels, call this method with the user ID, channel name, and new Token.</li>
                                </ul>
                            </li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="cpp">
                    <pt>channelId</pt>
                    <pd>The name of the channel you want to preload. Users with the same channel name under the same App ID will join the same channel. The channel name must be less than 64 bytes. Supported characters (89 total):
                        <ul>
                            <li>All lowercase letters: a to z.</li>
                            <li>All uppercase letters: A to Z.</li>
                            <li>All numeric characters: 0 to 9.</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ",".</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="cpp">
                    <pt>userAccount</pt>
                    <pd>The user account. You must set and manage the user account yourself, and ensure that each user account in the same channel is unique. The maximum length of this parameter is 255 bytes and it cannot be empty. Supported characters (89 total):
                        <ul>
                            <li>26 lowercase letters: a to z.</li>
                            <li>26 uppercase letters: A to Z.</li>
                            <li>All numeric characters: 0 to 9.</li>
                            <li>Space</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ",".</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>token</pt>
                    <pd>The token generated on your server for authentication. When the token used for preloading expires, you can update the token based on the number of preloaded channels:
                        <ul>
                            <li>To preload one channel, call this method with the new token.</li>
                            <li>To preload multiple channels:
                                <ul>
                                    <li>If you use a wildcard token for all preloaded channels, call <xref keyref="updatePreloadChannelToken"/> to update the token. Note: When generating a wildcard token, make sure the user ID is not 0.</li>
                                    <li>If you use different tokens for different channels, call this method with the User Account, channel name, and the new token.</li>
                                </ul>
                            </li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>channelName</pt>
                    <pd>The name of the channel you want to preload. The string length must be less than 64 bytes. Supported characters (89 total):
                        <ul>
                            <li>All lowercase English letters: a to z.</li>
                            <li>All uppercase English letters: A to Z.</li>
                            <li>All numeric characters: 0 to 9.</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ","</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>userAccount</pt>
                    <pd>The User Account used to identify the user in the channel. You need to set and manage the User Account yourself and ensure that each User Account in the same channel is unique. The maximum length of this parameter is 255 bytes and it cannot be empty. Supported characters (89 total):
                        <ul>
                            <li>26 lowercase English letters: a to z.</li>
                            <li>26 uppercase English letters: A to Z.</li>
                            <li>All numeric characters: 0 to 9.</li>
                            <li>Space</li>
                            <li>"!", "#", "$", "%", "&amp;", "(", ")", "+", "-", ":", ";", "&lt;", "=", ".", "&gt;", "?", "@", "[", "]", "^", "_", "{", "}", "|", "~", ","</li>
                        </ul>
                    </pd>
                </plentry>
            </parml>
        </section>
        <section id="return_values" props="android cpp">
            <title>Return Values</title>
            <p props="cpp">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure.
                        <ul>
                            <li>-2: Invalid parameter, e.g., empty user account. Please pass in valid parameters and rejoin the channel.</li>
                            <li>-7: The <xref keyref="IRtcEngine"/> object is not initialized. Please initialize <xref keyref="IRtcEngine"/> before calling this method.</li>
                            <li>-102: The channel name is invalid. Please provide a valid channel name and rejoin the channel.</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="android">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure.
                        <ul>
                            <li>-2: Invalid parameter, such as an empty User Account. Please provide valid parameters and rejoin the channel.</li>
                            <li>-7: The <xref keyref="IRtcEngine"/> object is not initialized. Please initialize the <xref keyref="IRtcEngine"/> object before calling this method.</li>
                            <li>-102: Invalid channel name. Please provide a valid channel name and rejoin the channel.</li>
                        </ul>
                    </li>
                </ul>
            </p>
        </section>
    </refbody>
</reference>