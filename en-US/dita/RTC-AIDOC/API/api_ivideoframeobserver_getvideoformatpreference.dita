<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="api_ivideoframeobserver_getvideoformatpreference">
    <title><ph keyref="getVideoFormatPreference"/></title>
    <shortdesc id="short"><ph id="shortdesc" props="cpp">Sets the format of raw video data output by the SDK.</ph><ph id="shortdesc" props="android">Sets the format of the raw video data output by the SDK.</ph></shortdesc>
    <prolog>
        <metadata>
            <keywords>
                <indexterm keyref="getVideoFormatPreference"/>
            </keywords>
        </metadata>
    </prolog>
    <refbody>
        <section id="prototype">
            <p outputclass="codeblock">
                <codeblock props="cpp" outputclass="language-cpp">virtual VIDEO_PIXEL_FORMAT getVideoFormatPreference() { return VIDEO_PIXEL_DEFAULT; }</codeblock>
                <codeblock props="android" outputclass="language-java">@CalledByNative int getVideoFormatPreference();</codeblock>
            </p>
        </section>
        <section id="detailed_desc" deliveryTarget="details" otherprops="no-title">
            <p props="cpp">After calling <xref keyref="registerVideoFrameObserver_IMediaEngine"/> to register the callback, the SDK triggers this callback each time a video frame is received. You need to set the preferred video data format in the return value of this callback.</p>
            <p props="android">After calling <xref keyref="registerVideoFrameObserver"/> to register the callback, the SDK triggers this callback each time it receives a video frame. You need to set the expected video data format in the return value of this callback.</p>
            <note props="cpp">The default pixel format of raw video (<codeph>VIDEO_PIXEL_DEFAULT</codeph>) is as follows:
                <ul>
                    <li>On Windows, the default video frame type is <codeph>YUV420</codeph>.</li>
                    <li>On Android, the default video frame type may be <codeph>I420Buffer</codeph> or <codeph>TextureBuffer</codeph>. The texture format of <codeph>TextureBuffer</codeph> may be OES or RGB. If the video frame type returned by calling <xref keyref="getVideoFormatPreference"/> is <codeph>VIDEO_PIXEL_DEFAULT</codeph>, you need to adapt to <codeph>I420Buffer</codeph> or <codeph>TextureBuffer</codeph> when processing video data. Cases where the video frame type is fixed to <codeph>I420Buffer</codeph> include but are not limited to:
                        <ul>
                            <li>Specific devices, such as: LG G5 SE (H848), Google Pixel 4a, Samsung Galaxy A7, or Xiaomi Max.</li>
                            <li>When beauty effect extensions are integrated and video denoising or low-light enhancement is enabled.</li>
                        </ul>
                    </li>
                    <li>On iOS and macOS, the default video frame type may be <codeph>I420</codeph> or <codeph>CVPixelBufferRef</codeph>.</li>
                </ul>
            </note>
            <note props="android"><codeph>VIDEO_PIXEL_DEFAULT</codeph> indicates the default pixel format of the raw video, as follows:
                <ul>
                    <li>On Android, the default video frame type may be <codeph>I420Buffer</codeph> or <codeph>TextureBuffer</codeph>. The texture format of <codeph>TextureBuffer</codeph> may be OES or RGB. If the video frame type returned by <xref keyref="getVideoFormatPreference"/> is <codeph>VIDEO_PIXEL_DEFAULT</codeph>, you must handle both <codeph>I420Buffer</codeph> and <codeph>TextureBuffer</codeph>.</li>
                </ul><ph>  Cases where the video frame type is fixed to <codeph>I420Buffer</codeph> include but are not limited to:</ph>
                <ul>
                    <li>Specific devices, such as: LG G5 SE (H848), Google Pixel 4a, Samsung Galaxy A7, or Xiaomi Max.</li>
                    <li>When beauty effect extension is integrated and video denoising or low light enhancement is enabled.</li>
                </ul>
            </note>
        </section>
        <section id="return_values" props="android cpp">
            <title>Return Values</title>
            <p props="cpp">Sets the format of raw video data. See <xref keyref="VIDEO_PIXEL_FORMAT"/>.</p>
            <p props="android">If the method call succeeds, returns the raw data format output by the SDK:
                <ul>
                    <li><codeph>VIDEO_PIXEL_DEFAULT</codeph> (0): Original video format, must support <codeph>I420Buffer</codeph> or <codeph>TextureBuffer</codeph>.</li>
                    <li><codeph>VIDEO_PIXEL_I420</codeph> (1): I420 format.</li>
                    <li><codeph>VIDEO_PIXEL_RGBA</codeph> (4): RGBA format.</li>
                    <li><codeph>VIDEO_PIXEL_I422</codeph> (16): I422 format.</li>
                </ul>
            </p>
        </section>
    </refbody>
</reference>