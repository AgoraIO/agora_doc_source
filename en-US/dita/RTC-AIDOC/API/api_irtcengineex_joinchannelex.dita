<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="api_irtcengineex_joinchannelex">
    <title><ph keyref="joinChannelEx"/></title>
    <shortdesc id="short"><ph id="shortdesc" props="cpp">Joins a channel.</ph><ph id="shortdesc" props="android">Joins a channel.</ph></shortdesc>
    <prolog>
        <metadata>
            <keywords>
                <indexterm keyref="joinChannelEx"/>
            </keywords>
        </metadata>
    </prolog>
    <refbody>
        <section id="prototype">
            <p outputclass="codeblock">
                <codeblock props="cpp" outputclass="language-cpp">virtual int joinChannelEx(const char* token, const RtcConnection&amp; connection, const ChannelMediaOptions&amp; options, IRtcEngineEventHandler* eventHandler) = 0;</codeblock>
                <codeblock props="android" outputclass="language-java">public abstract int joinChannelEx(String token, RtcConnection connection, ChannelMediaOptions options, IRtcEngineEventHandler eventHandler);</codeblock>
            </p>
        </section>
        <section id="detailed_desc" deliveryTarget="details" otherprops="no-title">
            <p props="cpp">You can call this method multiple times to join multiple channels.
In multi-camera capture scenarios, after calling this method, you need to call the <codeph>startPreview</codeph> method and set <codeph>sourceType</codeph> to <codeph>VIDEO_SOURCE_CAMERA_SECONDARY</codeph> to ensure the secondary camera captures properly.</p>
            <p props="android">You can call this method multiple times to join multiple channels.

In multi-camera capture scenarios, after calling this method, you need to call <codeph>startPreview</codeph> and set <codeph>sourceType</codeph> to <codeph>VIDEO_SOURCE_CAMERA_SECONDARY</codeph> to ensure proper capture from the second camera.</p>
            <note props="cpp">If you are already in a channel, you cannot rejoin the same channel using the same user ID.
Before joining a channel, make sure the App ID used to generate the token is the same as the App ID passed in the <xref keyref="initialize"/> method, otherwise joining the channel with the token may fail.</note>
            <note props="android">If you are already in a channel, you cannot rejoin the same channel using the same user ID.
Before joining a channel, ensure that the App ID used to generate the Token is the same as the one passed to <xref keyref="initialize"/>, otherwise joining the channel may fail.</note>
        </section>
        <section id="scenario" deliveryTarget="details">
            <title>Scenario</title>
            <p>This method applies to multi-channel scenarios.</p>
        </section>
        <section id="timing" deliveryTarget="details" props="android cpp">
            <title>Timing</title>
            <p props="cpp">Call this method after calling the <xref keyref="initialize"/> method.</p>
            <p props="android">Call this method after <xref keyref="initialize"/>.</p>
        </section>
        <section id="related" deliveryTarget="details" props="android cpp">
            <title>Related Callbacks</title>
            <p props="cpp">After successfully calling this method, the SDK triggers the following callbacks:
                <ul>
                    <li>Local client: <xref keyref="onJoinChannelSuccess"/> and <xref keyref="onConnectionStateChanged"/> callbacks.</li>
                    <li>Remote client: In a <codeph>COMMUNICATION</codeph> channel, if a user joins the channel, or in a <codeph>LIVE_BROADCASTING</codeph> channel, if a host joins, the <xref keyref="onUserJoined"/> callback is triggered.</li>
                </ul><ph>If the connection between the local client and the Agora server is interrupted due to poor network conditions, the SDK attempts to reconnect. When the local client successfully rejoins the channel, the SDK triggers the <xref keyref="onRejoinChannelSuccess"/> callback on the local client.</ph></p>
            <p props="android">If the method call succeeds, the following callbacks are triggered:
                <ul>
                    <li>Local client: <xref keyref="onJoinChannelSuccess"/> and <xref keyref="onConnectionStateChanged"/>.</li>
                    <li>Remote client: If a user joins in a <codeph>COMMUNICATION</codeph> channel or a host joins in a <codeph>LIVE_BROADCASTING</codeph> channel, <xref keyref="onUserJoined"/> is triggered.</li>
                </ul><ph>If the connection between the local client and the Agora server is interrupted due to poor network conditions, the SDK will attempt to reconnect. When the local client successfully rejoins the channel, the SDK triggers the <xref keyref="onRejoinChannelSuccess"/> callback.</ph></p>
        </section>
        <section id="parameters" deliveryTarget="details" props="android cpp">
            <title>Parameters</title>
            <parml>
                <plentry props="cpp">
                    <pt>token</pt>
                    <pd>The token used for authentication, generated by your server.
                        <note>
                            <ul>
                                <li>(Recommended) If your project has enabled secure mode (authentication using App ID and token), this parameter is required.</li>
                                <li>If you only enabled test mode (authentication using App ID), this parameter is optional. After successfully joining the channel, you will automatically leave the channel after 24 hours.</li>
                                <li>If you need to join different channels simultaneously or switch between channels, Agora recommends using a wildcard token so you don't have to request a new token each time. See <codeph>Secure authentication with tokens</codeph>.</li>
                            </ul>
                        </note>
                    </pd>
                </plentry>
                <plentry props="cpp">
                    <pt>connection</pt>
                    <pd>Connection information. See <xref keyref="RtcConnection"/>.</pd>
                </plentry>
                <plentry props="cpp">
                    <pt>options</pt>
                    <pd>Channel media options. See <xref keyref="ChannelMediaOptions"/>.</pd>
                </plentry>
                <plentry props="cpp">
                    <pt>eventHandler</pt>
                    <pd>Callback class. See <xref keyref="IRtcEngineEventHandler"/>. You can use the <codeph>eventHandler</codeph> object passed through this parameter to get callback events for multiple channels.</pd>
                </plentry>
                <plentry props="android">
                    <pt>token</pt>
                    <pd>The token used for authentication.
                        <note>
                            <ul>
                                <li>(Recommended) If your project enables secure mode (App ID + Token authentication), this parameter is required.</li>
                                <li>If you only enable test mode (App ID authentication), this parameter is optional. You will automatically leave the channel after 24 hours.</li>
                                <li>If you need to join different channels simultaneously or switch between channels, Agora recommends using a wildcard Token so you don't need to request a new Token each time.</li>
                            </ul>
                        </note>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>connection</pt>
                    <pd>Connection information. See <xref keyref="RtcConnection"/>.</pd>
                </plentry>
                <plentry props="android">
                    <pt>options</pt>
                    <pd>Channel media options. See <xref keyref="ChannelMediaOptions"/>.</pd>
                </plentry>
                <plentry props="android">
                    <pt>eventHandler</pt>
                    <pd>Callback class. See <xref keyref="IRtcEngineEventHandler"/>. You can use the <codeph>eventHandler</codeph> object passed in this parameter to receive callback events for multiple channels.</pd>
                </plentry>
            </parml>
        </section>
        <section id="return_values" props="android cpp">
            <title>Return Values</title>
            <p props="cpp">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure.
                        <ul>
                            <li>-2: Invalid parameter. For example, the token is invalid, the <codeph>uid</codeph> parameter is not set to an integer, or a member value in <xref keyref="ChannelMediaOptions"/> is invalid. You need to pass in valid parameters and rejoin the channel.</li>
                            <li>-3: <xref keyref="IRtcEngine"/> object initialization failed. You need to reinitialize the <xref keyref="IRtcEngine"/> object.</li>
                            <li>-7: <xref keyref="IRtcEngine"/> object is not initialized. You need to initialize the <xref keyref="IRtcEngine"/> object before calling this method.</li>
                            <li>-8: Internal state error of the <xref keyref="IRtcEngine"/> object. A typical cause is calling this method to join a channel after calling <xref keyref="startEchoTest3"/> without calling <xref keyref="stopEchoTest"/> to stop the test. You need to call <xref keyref="stopEchoTest"/> before calling this method.</li>
                            <li>-17: Join channel request is rejected. A typical reason is that the user is already in the channel. Agora recommends checking the user's channel status via the <xref keyref="onConnectionStateChanged"/> callback. Only call this method to join the channel when receiving the <codeph>CONNECTION_STATE_DISCONNECTED</codeph> (1) state.</li>
                            <li>-102: Invalid channel name. You need to pass a valid channel name in <codeph>channelId</codeph> to rejoin the channel.</li>
                            <li>-121: Invalid user ID. You need to pass a valid user ID in <codeph>uid</codeph> to rejoin the channel.</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="android">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure.
                        <ul>
                            <li>-2: Invalid parameters. For example, invalid Token, <codeph>uid</codeph> is not set to an integer, or invalid member value in <xref keyref="ChannelMediaOptions"/>. You need to pass valid parameters and rejoin the channel.</li>
                            <li>-3: Failed to initialize the <xref keyref="IRtcEngine"/> object. You need to reinitialize the <xref keyref="IRtcEngine"/> object.</li>
                            <li>-7: <xref keyref="IRtcEngine"/> is not initialized. You must initialize the <xref keyref="IRtcEngine"/> object before calling this method.</li>
                            <li>-8: Internal state error of the <xref keyref="IRtcEngine"/> object. A typical reason is that <xref keyref="startEchoTest3"/> was called but <xref keyref="stopEchoTest"/> was not called before joining the channel. You need to call <xref keyref="stopEchoTest"/> before calling this method.</li>
                            <li>-17: Join channel request is rejected. A typical reason is that the user is already in the channel. Agora recommends that you determine whether the user is in a channel by using the <xref keyref="onConnectionStateChanged"/> callback. Only call this method when you receive <codeph>CONNECTION_STATE_DISCONNECTED</codeph> (1).</li>
                            <li>-102: Invalid channel name. You need to pass a valid channel name in <codeph>channelId</codeph> to rejoin the channel.</li>
                            <li>-121: Invalid user ID. You need to pass a valid user ID in <codeph>uid</codeph> to rejoin the channel.</li>
                        </ul>
                    </li>
                </ul>
            </p>
        </section>
    </refbody>
</reference>