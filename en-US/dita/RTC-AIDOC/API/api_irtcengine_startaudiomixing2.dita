<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="api_irtcengine_startaudiomixing2">
    <title><ph keyref="startAudioMixing2"/></title>
    <shortdesc id="short"><ph id="shortdesc" props="cpp">Starts playing a music file.</ph><ph id="shortdesc" props="android">Starts playing a music file.</ph></shortdesc>
    <prolog>
        <metadata>
            <keywords>
                <indexterm keyref="startAudioMixing2"/>
            </keywords>
        </metadata>
    </prolog>
    <refbody>
        <section id="prototype">
            <p outputclass="codeblock">
                <codeblock props="cpp" outputclass="language-cpp">virtual int startAudioMixing(const char* filePath, bool loopback, int cycle, int startPos) = 0;</codeblock>
                <codeblock props="android" outputclass="language-java">public abstract int startAudioMixing(String filePath, boolean loopback, int cycle, int startPos);</codeblock>
            </p>
        </section>
        <section id="detailed_desc" deliveryTarget="details" otherprops="no-title">
            <p props="cpp">If the local music file does not exist, the SDK does not support the file format, or the music file URL is not accessible, the SDK returns <codeph>AUDIO_MIXING_REASON_CAN_NOT_OPEN</codeph>.</p>
            <p props="android">This method supports playing URI files starting with <codeph>content://</codeph>. If the local music file does not exist, the SDK does not support the file format, or the music file URL is inaccessible, the SDK returns <codeph>AUDIO_MIXING_REASON_CAN_NOT_OPEN</codeph>.</p>
            <note props="cpp">
                <ul>
                    <li>If you use this method to play short sound effect files, playback may fail. Agora recommends using <xref keyref="playEffect3"/> for such files.</li>
                    <li>If you need to call this method multiple times, ensure the interval between calls is greater than 500 ms.</li>
                    <li>On Android, note the following:
                        <ul>
                            <li>Ensure the Android device version is v4.2 or higher and the API level is v16 or higher.</li>
                            <li>If you need to play online music files, Agora does not recommend using redirected URLs. Some Android devices may not be able to open redirected URLs.</li>
                            <li>If you call this method on an emulator, ensure the music file is located in the <codeph>/sdcard/</codeph> directory and is in MP3 format.</li>
                        </ul>
                    </li>
                </ul>
            </note>
            <note props="android">
                <ul>
                    <li>If you call this method to play a short sound effect file, it may fail. Agora recommends using the <codeph>playEffect</codeph> method to play such files.</li>
                    <li>If you need to call this method multiple times, ensure that the interval between calls is greater than 500 ms.</li>
                    <li>On Android, note the following:
                        <ul>
                            <li>The device must run Android v4.2 or later and API level v16 or higher.</li>
                            <li>When playing online music files, Agora does not recommend using redirected URLs, as some Android devices may not support them.</li>
                            <li>If calling this method on an emulator, ensure that the music file is located in the <codeph>/sdcard/</codeph> directory and is in MP3 format.</li>
                        </ul>
                    </li>
                </ul>
            </note>
        </section>
        <section id="timing" deliveryTarget="details" props="android cpp">
            <title>Timing</title>
            <p props="cpp">You can call this method before or after joining a channel.</p>
            <p props="android">You can call this method before or after joining a channel.</p>
        </section>
        <section id="related" deliveryTarget="details" props="android cpp">
            <title>Related Callbacks</title>
            <p props="cpp">After successfully calling this method, the SDK triggers the <xref keyref="onAudioMixingStateChanged"/> (<codeph>AUDIO_MIXING_STATE_PLAYING</codeph>) callback. When the audio mixing file finishes playing, the SDK triggers the <xref keyref="onAudioMixingStateChanged"/> (<codeph>AUDIO_MIXING_STATE_STOPPED</codeph>) callback on the local client.</p>
            <p props="android">Successfully calling this method triggers the <xref keyref="onAudioMixingStateChanged"/> (<codeph>AUDIO_MIXING_STATE_PLAYING</codeph>) callback. When the audio mixing file finishes playing, the SDK triggers the <xref keyref="onAudioMixingStateChanged"/> (<codeph>AUDIO_MIXING_STATE_STOPPED</codeph>) callback locally.</p>
        </section>
        <section id="parameters" deliveryTarget="details" props="android cpp">
            <title>Parameters</title>
            <parml>
                <plentry props="cpp">
                    <pt>filePath</pt>
                    <pd>File path:
                        <ul>
                            <li>Android: The path must include the file name and extension. Supports URL, absolute path, or paths starting with <codeph>/assets/</codeph>. Using an absolute path to access local files may cause permission issues. It is recommended to use a URI, for example: <codeph>content://com.android.providers.media.documents/document/audio%3A14441</codeph>.</li>
                            <li>Windows: The absolute path or URL of the sound effect file (including the file extension), for example: <xref keyref="filePath-example"/>.</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="cpp">
                    <pt>loopback</pt>
                    <pd>Whether to play the music file only on the local client:
                        <ul>
                            <li><xref keyref="true"/>: Play locally only; only the local user hears the music.</li>
                            <li><xref keyref="false"/>: Publish the music to remote; remote users also hear the music.</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="cpp">
                    <pt>cycle</pt>
                    <pd>Number of times the music file is played:
                        <ul>
                            <li>&gt;0: Play the specified number of times. For example, 1 means play once.</li>
                            <li>-1: Loop indefinitely.</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="cpp">
                    <pt>startPos</pt>
                    <pd>The start position (in milliseconds) to play the music file.</pd>
                </plentry>
                <plentry props="android">
                    <pt>filePath</pt>
                    <pd>The file path. The path must include the file name and extension. Supports URL, absolute path, or paths starting with <codeph>/assets/</codeph>. Accessing local files using absolute paths may cause permission issues. Agora recommends using URI, for example: <codeph>content://com.android.providers.media.documents/document/audio%3A14441</codeph>.</pd>
                </plentry>
                <plentry props="android">
                    <pt>loopback</pt>
                    <pd>Whether to play the music file only locally:
                        <ul>
                            <li><xref keyref="true"/>: Play locally only. Only the local user hears the music.</li>
                            <li><xref keyref="false"/>: Publish the music to remote users as well.</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>cycle</pt>
                    <pd>Number of times to play the music file:
                        <ul>
                            <li>&gt; 0: Play the specified number of times. For example, 1 means play once.</li>
                            <li>-1: Loop indefinitely.</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>startPos</pt>
                    <pd>The starting position (in milliseconds) for playing the music file.</pd>
                </plentry>
            </parml>
        </section>
        <section id="return_values" props="android cpp">
            <title>Return Values</title>
            <p props="cpp">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure.
                        <ul>
                            <li>-1: General error (no specific reason).</li>
                            <li>-2: Invalid parameter.</li>
                            <li>-3: SDK not ready:
                                <ul>
                                    <li>Audio module is disabled.</li>
                                    <li>Program not completed.</li>
                                    <li><xref keyref="IRtcEngine"/> initialization failed. Please reinitialize <xref keyref="IRtcEngine"/>.</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="android">
                <ul>
                    <li>0: Success.</li>
                    <li>&lt; 0: Failure.
                        <ul>
                            <li>-1: General error (unspecified reason).</li>
                            <li>-2: Invalid parameter.</li>
                            <li>-3: SDK not ready:
                                <ul>
                                    <li>Audio module not enabled.</li>
                                    <li>Incomplete setup.</li>
                                    <li><xref keyref="IRtcEngine"/> initialization failed. Please reinitialize <xref keyref="IRtcEngine"/>.</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </p>
        </section>
    </refbody>
</reference>