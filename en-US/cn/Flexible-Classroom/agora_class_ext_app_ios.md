## Overview

Extended application ExtApp is a supplementary plug-in for  Flexible Classroom. You can understand ExtApp as a relatively independent App with its own life cycle and data management, but it also depends on the Agora Classroom SDK. You can customize the UI of the plug-in through ExtApp, pass custom data and monitor data changes, and embed custom plug-ins, such as countdown, dice, etc., in the  Flexible Classroom.

The source code of ExtApp is located in the [AgoraExtApp` directory in `the CloudClass-iOS](https://github.com/AgoraIO-Community/CloudClass-iOS) repository on GitHub.

The following describes the basic steps of embedding custom plug-ins in Smart Classroom by extending ExtApp.

## Implement real-time messaging

### 1. Implement the plug-in

First, you need to inherit the `AgoraBaseExtApp` class and implement a custom plug-in in your App.

The methods and callbacks in the` AgoraExtAppBase` class are introduced as follows:

#### Method

**initWithAppIdentifier**

```swift
(instancetype)initWithAppIdentifier:(NSString *)appIdentifier
                      localUserInfo: (AgoraExtAppUserInfo *) userInfo
                           roomInfo:(AgoraExtAppRoomInfo *)roomInfo
                         properties:(NSDictionary *)properties;
```

Initialize the plugin.

**updateProperties**

```swift
(void)updateProperties:(NSDictionary *)properties
               success:(AgoraExtAppCompletion)success
                  fail:(AgoraExtAppErrorCompletion)fail;
```

Update attributes. Other plug-ins will` receive updated property information through propertiesDidUpdate`.

**deleteProperties**

```swift
(void)deleteProperties:(NSArray <NSString *> *)keys
               success:(AgoraExtAppCompletion)success
                  fail:(AgoraExtAppErrorCompletion)fail;
```

Delete attributes. Other plug-ins will` receive the deleted property information through propertiesDidUpdate`.

**unload**

```swift
(void)unload;
```

Remove the plug-in. After successfully calling this method, the `onExtAppUnloaded `callback will be triggered.

#### Callback

**propertiesDidUpdate**

```swift
(void)propertiesDidUpdate:(NSDictionary *)properties;
```

The attributes have been updated.

**extAppDidLoad**

```swift
(void)extAppDidLoad:(AgoraExtAppContext *)context;
```

The plugin has been loaded. You can initialize in this callback.

**extAppWillUnload**

```swift
(void)extAppWillUnload;
```

The plugin will be uninstalled. You can perform operations such as data backup in this callback.

### 2. Register the plugin

Call the `Agora method to register the plug-in` in the Agora Classroom SDK.

The following sample code demonstrates how to register a countdown plug-in CountDownExtApp.

```swift
// appIdentifier: The plug-in ID, which will be used to identify the plug-in. The same plug-in on different platforms must use the same ID. 
// extAppClass: Container App Class Type, an instance of this class is created by the SDK. 
// frame: the size of the plug-in container, representing the distance from the bottom view. The bottom view is generated by the Classroom SDK (not including the security zone). 
// language: container language, Classroom SDK will pass this variable to the specific plug-in container, so that the container can set multiple languages by itself. 
let countDown = AgoraExtAppConfiguration (appIdentifier: "io.agora.countdown",
                                         extAppClass: CountDownExtApp.self,
                                         frame: UIEdgeInsets(top: 10,
                                                            left: 50,
                                                          bottom: 10,
                                                           right: 50),
                                                        language: "en",


// The plug-in icon is used to set on the UIKit layer, and will be displayed in the toolbox pop-up window of the whiteboard toolbar by default. 
countDown.image = image
countDown.selectedImage = selectedImage
let apps = [countDown]
AgoraEduSDK.registerExtApps(apps)
```

### 3. Start the plugin

By default, successfully registered plug-ins will be displayed in the toolbox pop-up window of the  Flexible Classroom whiteboard toolbar.

If you want to customize an entry for the plug-in, you can modify the corresponding file of the UI Kit module, add an entry for the plug-in in the three major scenes of  Flexible Classroom, and then call the following method when the plug-in is clicked or displayed.

```java
// Pass in the plug-in ID in the willLaunchExtApp method. 
extAppContext?.willLaunchExtApp(appIdentifier)
```
