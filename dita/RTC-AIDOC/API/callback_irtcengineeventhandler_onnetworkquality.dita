<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="callback_irtcengineeventhandler_onnetworkquality">
    <title><ph keyref="onNetworkQuality"/></title>
    <shortdesc id="short"><ph id="shortdesc" props="cpp">报告频道中每个用户的 last mile 网络质量。</ph><ph id="shortdesc" props="android"><xref keyref="onNetworkQuality"/> 回调。报告频道中每个用户的最后一公里网络质量。</ph><ph id="shortdesc" props="ios">报告频道中每个用户的 last mile 网络质量。</ph><ph id="shortdesc" props="mac">报告频道中每个用户的 last mile 网络质量。</ph></shortdesc>
    <prolog>
        <metadata>
            <keywords>
                <indexterm keyref="onNetworkQuality"/>
            </keywords>
        </metadata>
    </prolog>
    <refbody>
        <section id="prototype">
            <p outputclass="codeblock">
                <codeblock props="cpp" outputclass="language-cpp">virtual void onNetworkQuality(uid_t uid, int txQuality, int rxQuality)</codeblock>
                <codeblock props="android" outputclass="language-java">public void onNetworkQuality(int uid, int txQuality, int rxQuality)</codeblock>
                <codeblock props="ios" outputclass="language-objectivec">- (void)rtcEngine:(AgoraRtcEngineKit * _Nonnull)engine networkQuality:(NSUInteger)uid txQuality:(AgoraNetworkQuality)txQuality rxQuality:(AgoraNetworkQuality)rxQuality NS_SWIFT_NAME(rtcEngine(_:networkQuality:txQuality:rxQuality:));</codeblock>
                <codeblock props="mac" outputclass="language-objectivec">- (void)rtcEngine:(AgoraRtcEngineKit * _Nonnull)engine networkQuality:(NSUInteger)uid txQuality:(AgoraNetworkQuality)txQuality rxQuality:(AgoraNetworkQuality)rxQuality NS_SWIFT_NAME(rtcEngine(_:networkQuality:txQuality:rxQuality:));</codeblock>
            </p>
        </section>
        <section id="detailed_desc" deliveryTarget="details" otherprops="no-title">
            <p props="cpp">该回调报告频道中每个用户的 last mile 网络状况。last mile 指的是本地设备与声网边缘服务器之间的连接。SDK 每两秒触发一次该回调。如果频道中有多个用户，SDK 会触发多次该回调。该回调通过在频道内发送和接收广播数据包来反馈网络质量。为避免广播风暴导致频道内数据传输量过大，该回调默认最多同时反馈 4 个远端用户的网络质量。</p>
            <p props="android">该回调通过在频道内发送和接收广播数据包来反馈网络质量。过多的广播数据包可能导致广播风暴。为防止广播风暴造成频道内大量数据传输，该回调默认最多同时反馈 4 个远端用户的网络质量。</p>
            <p props="ios"><xref keyref="onNetworkQuality"/> 回调报告频道中每个用户的 last mile 网络状况。last mile 指的是本地设备与声网边缘服务器之间的连接。SDK 每两秒触发一次该回调。如果频道中有多个用户，SDK 会触发多次该回调。该回调通过在频道内发送和接收广播数据包来反馈网络质量。过多的广播数据包可能会导致广播风暴。为防止广播风暴造成频道内大量数据传输，该回调默认支持同时反馈最多 4 个远端用户的网络质量。</p>
            <p props="mac"><xref keyref="onNetworkQuality"/> 回调报告频道中每个用户的 last mile 网络状况。last mile 指的是本地设备与声网边缘服务器之间的连接。SDK 每两秒触发一次该回调。如果频道中有多个用户，SDK 会触发多次该回调。该回调通过在频道内发送和接收广播数据包来反馈网络质量。过多的广播数据包可能会导致广播风暴。为防止广播风暴造成频道内大量数据传输，该回调默认支持同时反馈最多 4 个远端用户的网络质量。</p>
            <note props="cpp"><codeph>txQuality</codeph> 在用户未发送流时为 <codeph>UNKNOWN</codeph>；<codeph>rxQuality</codeph> 在用户未接收流时为 <codeph>UNKNOWN</codeph>。</note>
            <note props="android"><codeph>txQuality</codeph> 在用户未发送流时为 <codeph>UNKNOWN</codeph>；<codeph>rxQuality</codeph> 在用户未接收流时为 <codeph>UNKNOWN</codeph>。</note>
            <note props="ios"><codeph>txQuality</codeph> 在用户未发送流时为 <codeph>Unknown</codeph>；<codeph>rxQuality</codeph> 在用户未接收流时为 <codeph>Unknown</codeph>。</note>
            <note props="mac"><codeph>txQuality</codeph> 在用户未发送流时为 <codeph>Unknown</codeph>；<codeph>rxQuality</codeph> 在用户未接收流时为 <codeph>Unknown</codeph>。</note>
        </section>
        <section id="timing" deliveryTarget="details" props="android ios mac">
            <title>触发时机</title>
            <p props="android">该回调每两秒触发一次。</p>
            <p props="ios">该回调在 SDK 每两秒检测一次网络质量时被触发。</p>
            <p props="mac">该回调在 SDK 每两秒检测一次网络质量时被触发。</p>
        </section>
        <section id="parameters" deliveryTarget="details" props="android cpp ios mac">
            <title>参数</title>
            <parml>
                <plentry props="cpp">
                    <pt>uid</pt>
                    <pd>用户 ID。用于指定要报告网络质量的用户。如果该值为 0，则表示报告本地用户的网络质量。</pd>
                </plentry>
                <plentry props="cpp">
                    <pt>txQuality</pt>
                    <pd>用户的上行网络质量评分，依据上行网络的传输码率、丢包率、平均往返时延（RTT）和抖动情况评估。该评分有助于判断当前上行网络是否能支持所选的视频编码器配置。例如，1000 Kbps 的上行网络可能足以支持分辨率为 640 × 480、帧率为 15 fps 的视频帧，但可能不足以支持高于 1280 × 720 的分辨率。详见 <xref keyref="QUALITY_TYPE"/>。</pd>
                </plentry>
                <plentry props="cpp">
                    <pt>rxQuality</pt>
                    <pd>用户的下行网络质量评分，依据下行网络的丢包率、平均 RTT 和抖动情况评估。详见 <xref keyref="QUALITY_TYPE"/>。</pd>
                </plentry>
                <plentry props="android">
                    <pt>uid</pt>
                    <pd>用户 ID，用于标识被报告网络质量的用户。
                        <ul>
                            <li>0：表示本地用户。</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>txQuality</pt>
                    <pd>用户上行网络质量评分，依据传输码率、丢包率、平均往返时延（RTT）和抖动等指标评估。
                        <ul>
                            <li><codeph>QUALITY_UNKNOWN</codeph> (0)：质量未知。</li>
                            <li><codeph>QUALITY_EXCELLENT</codeph> (1)：质量极佳。</li>
                            <li><codeph>QUALITY_GOOD</codeph> (2)：网络质量看似极佳，但码率略低于极佳。</li>
                            <li><codeph>QUALITY_POOR</codeph> (3)：用户能感受到通信略有卡顿。</li>
                            <li><codeph>QUALITY_BAD</codeph> (4)：用户无法流畅通信。</li>
                            <li><codeph>QUALITY_VBAD</codeph> (5)：质量极差，用户几乎无法通信。</li>
                            <li><codeph>QUALITY_DOWN</codeph> (6)：网络连接已断，用户无法通信。</li>
                            <li><codeph>QUALITY_DETECTING</codeph> (8)：正在进行最后一公里探测测试。</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="android">
                    <pt>rxQuality</pt>
                    <pd>用户下行网络质量评分，依据丢包率、平均往返时延（RTT）和抖动等指标评估。
                        <ul>
                            <li><codeph>QUALITY_UNKNOWN</codeph> (0)：质量未知。</li>
                            <li><codeph>QUALITY_EXCELLENT</codeph> (1)：质量极佳。</li>
                            <li><codeph>QUALITY_GOOD</codeph> (2)：网络质量看似极佳，但码率略低于极佳。</li>
                            <li><codeph>QUALITY_POOR</codeph> (3)：用户能感受到通信略有卡顿。</li>
                            <li><codeph>QUALITY_BAD</codeph> (4)：用户无法流畅通信。</li>
                            <li><codeph>QUALITY_VBAD</codeph> (5)：质量极差，用户几乎无法通信。</li>
                            <li><codeph>QUALITY_DOWN</codeph> (6)：网络连接已断，用户无法通信。</li>
                            <li><codeph>QUALITY_DETECTING</codeph> (8)：正在进行最后一公里探测测试。</li>
                        </ul>
                    </pd>
                </plentry>
                <plentry props="ios">
                    <pt>engine</pt>
                    <pd><xref keyref="IRtcEngine"/> 对象。详见 <xref keyref="IRtcEngine"/>。</pd>
                </plentry>
                <plentry props="ios">
                    <pt>uid</pt>
                    <pd>用户 ID。该参数报告指定用户的网络质量。如果 <codeph>uid</codeph> 为 0，则报告本地用户的网络质量。</pd>
                </plentry>
                <plentry props="ios">
                    <pt>txQuality</pt>
                    <pd>用户的上行网络质量评分，依据传输码率、丢包率、平均往返时延（RTT）和抖动等指标评估。该评分有助于你了解当前上行网络状况是否能支持所选的视频编码器配置。例如，1000 Kbps 的上行网络可能足以支持在 <codeph>LIVE_BROADCASTING</codeph> 场景下分辨率为 640 × 480、帧率为 15 fps 的视频帧，但可能不足以支持高于 1280 × 720 的分辨率。详见 <xref keyref="QUALITY_TYPE"/>。</pd>
                </plentry>
                <plentry props="ios">
                    <pt>rxQuality</pt>
                    <pd>用户的下行网络质量评分，依据丢包率、平均 RTT 和抖动等指标评估。详见 <xref keyref="QUALITY_TYPE"/>。</pd>
                </plentry>
                <plentry props="mac">
                    <pt>engine</pt>
                    <pd><xref keyref="IRtcEngine"/> 对象。详见 <xref keyref="IRtcEngine"/>。</pd>
                </plentry>
                <plentry props="mac">
                    <pt>uid</pt>
                    <pd>用户 ID。该参数报告指定用户的网络质量。如果 <codeph>uid</codeph> 为 0，则报告本地用户的网络质量。</pd>
                </plentry>
                <plentry props="mac">
                    <pt>txQuality</pt>
                    <pd>用户的上行网络质量评分，依据传输码率、丢包率、平均往返时延（RTT）和抖动等指标评估。该评分有助于你了解当前上行网络状况是否能支持所选的视频编码器配置。例如，1000 Kbps 的上行网络可能足以支持在 <codeph>LIVE_BROADCASTING</codeph> 场景下分辨率为 640 × 480、帧率为 15 fps 的视频帧，但可能不足以支持高于 1280 × 720 的分辨率。详见 <xref keyref="QUALITY_TYPE"/>。</pd>
                </plentry>
                <plentry props="mac">
                    <pt>rxQuality</pt>
                    <pd>用户的下行网络质量评分，依据丢包率、平均 RTT 和抖动等指标评估。详见 <xref keyref="QUALITY_TYPE"/>。</pd>
                </plentry>
            </parml>
        </section>
    </refbody>
</reference>