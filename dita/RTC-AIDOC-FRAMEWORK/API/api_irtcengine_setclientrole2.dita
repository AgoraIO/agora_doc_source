<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="api_irtcengine_setclientrole2">
    <title><ph keyref="setClientRole2"/></title>
    <shortdesc id="short"><ph id="shortdesc" props="electron">设置直播场景下的用户角色和观众端延时级别。</ph><ph id="shortdesc" props="rn">设置直播场景下的用户角色和观众端延时级别。</ph><ph id="shortdesc" props="flutter">设置直播场景下的用户角色和观众端延时级别。</ph><ph id="shortdesc" props="unity">设置直播场景下的用户角色和观众端延时级别。</ph></shortdesc>
    <prolog>
        <metadata>
            <keywords>
                <indexterm keyref="setClientRole2"/>
            </keywords>
        </metadata>
    </prolog>
    <refbody>
        <section id="prototype">
            <p outputclass="codeblock">
                <codeblock props="electron" outputclass="language-typescript">abstract setClientRole(
    role: ClientRoleType,
    options?: ClientRoleOptions
  ): number;</codeblock>
                <codeblock props="rn" outputclass="language-typescript">abstract setClientRole(
    role: ClientRoleType,
    options?: ClientRoleOptions
  ): number;</codeblock>
                <codeblock props="flutter" outputclass="language-dart">Future&lt;void&gt; setClientRole(
    {required ClientRoleType role, ClientRoleOptions? options});</codeblock>
                <codeblock props="unity" outputclass="language-csharp">public abstract int SetClientRole(CLIENT_ROLE_TYPE role, ClientRoleOptions options);</codeblock>
            </p>
        </section>
        <section id="detailed_desc" deliveryTarget="details" otherprops="no-title">
            <p props="electron">SDK 默认设置用户角色为观众，你可以调用该方法设置用户角色为主播。用户角色（<codeph>role</codeph>）确定用户在 SDK 层的权限，包含是否有发流权限等。</p>
            <p props="rn">SDK 默认设置用户角色为观众，你可以调用该方法设置用户角色为主播。用户角色（<codeph>role</codeph>）确定用户在 SDK 层的权限，包含是否有发流权限等。</p>
            <p props="flutter">SDK 默认设置用户角色为观众，你可以调用该方法设置用户角色为主播。用户角色（<codeph>role</codeph>）确定用户在 SDK 层的权限，包含是否有发流权限等。</p>
            <p props="unity">SDK 默认设置用户角色为观众，你可以调用该方法设置用户角色为主播。用户角色（<codeph>role</codeph>）确定用户在 SDK 层的权限，包含是否有发流权限等。
该方法与 <xref keyref="setClientRole1"/> 的区别在于，该方法还支持设置观众端延时级别（<codeph>audienceLatencyLevel</codeph>）。<codeph>audienceLatencyLevel</codeph> 需与 <codeph>role</codeph> 结合使用，确定用户在其权限范围内可以享受到的服务。例如对于观众，选择接收低延时还是超低延时的视频流。
不同的延时级别会影响计费，详见[计费策略](https://doc.shengwang.cn/doc/rtc/android/billing/billing-strategy#%E6%9E%81%E9%80%9F%E7%9B%B4%E6%92%AD%E8%A7%82%E4%BC%97%E8%B4%B9%E7%94%A8)。</p>
            <note props="electron">当用户角色设为主播时，观众端延时级别仅支持设置为 AudienceLatencyLevelUltraLowLatency（超低延时）。
在加入频道前调用该方法并将 <codeph>role</codeph> 设为 <codeph>BROADCASTER</codeph>（主播）时，本地不会触发 <xref keyref="onClientRoleChanged"/> 回调。</note>
            <note props="rn">当用户角色设为主播时，观众端延时级别仅支持设置为 AudienceLatencyLevelUltraLowLatency（超低延时）。
在加入频道前调用该方法并将 <codeph>role</codeph> 设为 <codeph>BROADCASTER</codeph>（主播）时，本地不会触发 <xref keyref="onClientRoleChanged"/> 回调。</note>
            <note props="flutter">当用户角色设为主播时，观众端延时级别仅支持设置为 audienceLatencyLevelUltraLowLatency（超低延时）。
在加入频道前调用该方法并将 <codeph>role</codeph> 设为 <codeph>BROADCASTER</codeph>（主播）时，本地不会触发 <xref keyref="onClientRoleChanged"/> 回调。</note>
            <note props="unity">当用户角色设为主播时，观众端延时级别仅支持设置为 AUDIENCE_LATENCY_LEVEL_ULTRA_LOW_LATENCY（超低延时）。
在加入频道前调用该方法并将 <codeph>role</codeph> 设为 <codeph>BROADCASTER</codeph>（主播）时，本地不会触发 <xref keyref="onClientRoleChanged"/> 回调。</note>
        </section>
        <section id="timing" deliveryTarget="details" props="electron flutter rn unity">
            <title>调用时机</title>
            <p props="electron">该方法在加入频道前后均可调用。
如果你在加入频道前调用该方法设置用户角色为主播、并且通过 <xref keyref="setupLocalVideo"/> 方法设置了本地视频属性，则用户加入频道时会自动开启本地视频预览。
如果你在加入频道后调用该方法切换用户角色，调用成功后，SDK 会自动调用 <xref keyref="muteLocalAudioStream"/> 和 <xref keyref="muteLocalVideoStream"/> 修改发布音视频流的状态。</p>
            <p props="rn">该方法在加入频道前后均可调用。
如果你在加入频道后调用该方法切换用户角色，调用成功后，SDK 会自动调用 <xref keyref="muteLocalAudioStream"/> 和 <xref keyref="muteLocalVideoStream"/> 修改发布音视频流的状态。</p>
            <p props="flutter">该方法在加入频道前后均可调用。
如果你在加入频道前调用该方法设置用户角色为主播、并且通过 <xref keyref="setupLocalVideo"/> 方法设置了本地视频属性，则用户加入频道时会自动开启本地视频预览。
如果你在加入频道后调用该方法切换用户角色，调用成功后，SDK 会自动调用 <xref keyref="muteLocalAudioStream"/> 和 <xref keyref="muteLocalVideoStream"/> 修改发布音视频流的状态。</p>
            <p props="unity">该方法在加入频道前后均可调用。
如果你在加入频道前调用该方法设置用户角色为主播、并且调用 <xref keyref="setEnable"/> 方法开启视频渲染，则用户加入频道时会自动开启本地视频预览。
如果你在加入频道后调用该方法切换用户角色，调用成功后，SDK 会自动调用 <xref keyref="muteLocalAudioStream"/> 和 <xref keyref="muteLocalVideoStream"/> 修改发布音视频流的状态。</p>
        </section>
        <section id="related" deliveryTarget="details" props="electron flutter rn unity">
            <title>相关回调</title>
            <p props="electron">如果你在加入频道后成功调用该方法切换用户角色，SDK 会触发下列回调：
                <ul>
                    <li>本地触发 <xref keyref="onClientRoleChanged"/> 回调。在加入频道前调用该方法并将 <codeph>role</codeph> 设为 <codeph>AUDIENCE</codeph>（观众）时，也会触发该回调。</li>
                    <li>远端触发 <xref keyref="onUserJoined"/> 或 <xref keyref="onUserOffline"/> 回调。</li>
                </ul><ph>如果你在加入频道后调用该方法切换用户角色失败，SDK 会触发 <xref keyref="onClientRoleChangeFailed"/>，报告切换失败的原因和当前的用户角色。</ph></p>
            <p props="rn">如果你在加入频道后成功调用该方法切换用户角色，SDK 会触发下列回调：
                <ul>
                    <li>本地触发 <xref keyref="onClientRoleChanged"/> 回调。在加入频道前调用该方法并将 <codeph>role</codeph> 设为 <codeph>AUDIENCE</codeph>（观众）时，也会触发该回调。</li>
                    <li>远端触发 <xref keyref="onUserJoined"/> 或 <xref keyref="onUserOffline"/> 回调。</li>
                </ul><ph>如果你在加入频道后调用该方法切换用户角色失败，SDK 会触发 <xref keyref="onClientRoleChangeFailed"/>，报告切换失败的原因和当前的用户角色。</ph></p>
            <p props="flutter">如果你在加入频道后成功调用该方法切换用户角色，SDK 会触发下列回调：
                <ul>
                    <li>本地触发 <xref keyref="onClientRoleChanged"/> 回调。在加入频道前调用该方法并将 <codeph>role</codeph> 设为 <codeph>AUDIENCE</codeph>（观众）时，也会触发该回调。</li>
                    <li>远端触发 <xref keyref="onUserJoined"/> 或 <xref keyref="onUserOffline"/> 回调。</li>
                </ul><ph>如果你在加入频道后调用该方法切换用户角色失败，SDK 会触发 <xref keyref="onClientRoleChangeFailed"/>，报告切换失败的原因和当前的用户角色。</ph></p>
            <p props="unity">如果你在加入频道后成功调用该方法切换用户角色，SDK 会触发下列回调：
                <ul>
                    <li>本地触发 <xref keyref="onClientRoleChanged"/> 回调。在加入频道前调用该方法并将 <codeph>role</codeph> 设为 <codeph>AUDIENCE</codeph>（观众）时，也会触发该回调。</li>
                    <li>远端触发 <xref keyref="onUserJoined"/> 或 <xref keyref="onUserOffline"/> 回调。</li>
                </ul><ph>如果你在加入频道后调用该方法切换用户角色失败，SDK 会触发 <xref keyref="onClientRoleChangeFailed"/>，报告切换失败的原因和当前的用户角色。</ph></p>
        </section>
        <section id="parameters" deliveryTarget="details" props="electron flutter rn unity">
            <title>参数</title>
            <parml>
                <plentry props="electron">
                    <pt>role</pt>
                    <pd>用户角色。详见 <xref keyref="CLIENT_ROLE_TYPE"/>。
                        <note>角色为观众的用户无法在频道内发布音视频流。在直播场景下发流时，请确保你的用户角色已切换为主播。</note>
                    </pd>
                </plentry>
                <plentry props="electron">
                    <pt>options</pt>
                    <pd>用户具体设置，包含用户级别。详见 <xref keyref="ClientRoleOptions"/>。</pd>
                </plentry>
                <plentry props="rn">
                    <pt>role</pt>
                    <pd>用户角色。详见 <xref keyref="CLIENT_ROLE_TYPE"/>。
                        <note>角色为观众的用户无法在频道内发布音视频流。在直播场景下发流时，请确保你的用户角色已切换为主播。</note>
                    </pd>
                </plentry>
                <plentry props="rn">
                    <pt>options</pt>
                    <pd>用户具体设置，包含用户级别。详见 <xref keyref="ClientRoleOptions"/>。</pd>
                </plentry>
                <plentry props="flutter">
                    <pt>role</pt>
                    <pd>用户角色。详见 <xref keyref="CLIENT_ROLE_TYPE"/>。
                        <note>角色为观众的用户无法在频道内发布音视频流。在直播场景下发流时，请确保你的用户角色已切换为主播。</note>
                    </pd>
                </plentry>
                <plentry props="flutter">
                    <pt>options</pt>
                    <pd>用户具体设置，包含用户级别。详见 <xref keyref="ClientRoleOptions"/>。</pd>
                </plentry>
                <plentry props="unity">
                    <pt>role</pt>
                    <pd>用户角色。详见 <xref keyref="CLIENT_ROLE_TYPE"/>。
                        <note>角色为观众的用户无法在频道内发布音视频流。在直播场景下发流时，请确保你的用户角色已切换为主播。</note>
                    </pd>
                </plentry>
                <plentry props="unity">
                    <pt>options</pt>
                    <pd>用户具体设置，包含用户级别。详见 <xref keyref="ClientRoleOptions"/>。</pd>
                </plentry>
            </parml>
        </section>
        <section id="return_values" props="electron flutter rn unity">
            <title>返回值</title>
            <p props="electron">
                <ul>
                    <li>0: 方法调用成功。</li>
                    <li>&lt; 0: 方法调用失败。详见[错误码](https://doc.shengwang.cn/api-ref/rtc/electron/error-code)了解详情和解决建议。
                        <ul>
                            <li>-1: 一般性的错误（未明确归类）。</li>
                            <li>-2: 参数无效。</li>
                            <li>-5: 调用被拒绝。</li>
                            <li>-7: SDK 尚未初始化。</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="rn">
                <ul>
                    <li>0: 方法调用成功。</li>
                    <li>&lt; 0: 方法调用失败。详见[错误码](https://doc.shengwang.cn/api-ref/rtc/rn/error-code)了解详情和解决建议。
                        <ul>
                            <li>-1: 一般性的错误（未明确归类）。</li>
                            <li>-2: 参数无效。</li>
                            <li>-5: 调用被拒绝。</li>
                            <li>-7: SDK 尚未初始化。</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p props="flutter">方法成功调用时，无返回值；方法调用失败时，会抛出 <xref keyref="AgoraRtcException"/> 异常，你需要捕获异常并进行处理。详见[错误码](https://doc.shengwang.cn/api-ref/rtc/flutter/error-code)了解详情和解决建议。</p>
            <p props="unity">
                <ul>
                    <li>0: 方法调用成功。</li>
                    <li>&lt; 0: 方法调用失败。详见[错误码](https://doc.shengwang.cn/api-ref/rtc/unity/error-code)了解详情和解决建议。
                        <ul>
                            <li>-1: 一般性的错误（未明确归类）。</li>
                            <li>-2: 参数无效。</li>
                            <li>-5: 调用被拒绝。</li>
                            <li>-7: SDK 尚未初始化。</li>
                        </ul>
                    </li>
                </ul>
            </p>
        </section>
    </refbody>
</reference>