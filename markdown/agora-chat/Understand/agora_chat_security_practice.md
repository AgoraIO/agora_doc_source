安全合规对于即时通讯技术至关重要，为了提供安全可靠的云服务，即时通讯 IM 遵循不同国家、地区和行业的合规要求。即时通讯 IM 采用多种安全措施，防御即时通讯场景中的常见攻击。

本文介绍即时通讯 IM 采用的一些安全最佳实践以及为开发者提供的安全工具。

| 安全措施             | 默认启用 | 推荐场景               |
| :------------------- | :------- | :--------------------- |
| 数据中心隔离 | 是       | 所有即时通讯场景。                                  |
| Token 鉴权   | 是       | 所有即时通讯应用都必须使用用户身份的 token 进行鉴权。 |
| 数据传输加密 | 是       | 所有即时通讯场景。                                  |
| 数据存储加密 | 是       | 所有即时通讯场景。                                  |

## 数据中心隔离

为了满足不同国家和地区的法律和规定，即时通讯 IM 支持服务区域隔离，以保证指定区域内的用户隐私数据不跨境。

即时通讯 IM 在如下区域设立数据中心，数据中心支持区域访问：

| 数据中心 | 地点           | 服务区域   |
| :------- | :------------- | :------- |
| 新加坡   | 新加坡         | 东南亚   |
| 中国大陆 | 北京           | 中国大陆 |
| 欧洲     | 法兰克福，德国 | 欧洲     |
| 北美     | 弗吉尼亚，美国 | 北美     |

使用即时通讯 IM 服务时，需要指定数据中心，目前中国大陆账号只能选择中国大陆数据中心，需要部署海外数据中心请联系 [sales@agora.io](mailto:sales@agora.io)。选择数据中心后，REST 和 SDK API 对于消息服务器的请求都将指向对应的数据中心。

数据中心一经选定不可更改。即时通讯 IM 不支持跨区域的数据迁移服务。所有数据均会保存在指定的数据中心。

## Token 鉴权

即时通讯 IM 使用 token 进行最终用户身份验证。Token 是一个访问密钥，开发者可以设置 token 的有效期。它允许最终用户在用户通过应用程序正确验证后访问即时通讯 IM 服务。它由应用后端生成，包含以下重要信息：

- Agora 项目的 App ID
- Agora 项目的 App 证书
- 待认证用户的用户ID

## 数据传输和存储

用户和即时通讯 IM 服务器的通信进行了传输加密，比如：即时通讯 IM 私有传输协议，Transport Layer Security (TLS) 和 Web Socket Secure (WSS)。使用即时通讯 IM 产生的用户数据和消息将存储在指定的区域的数据中心。我们仅在为您提供服务期间保留您的信息，保留时间不超过满足相关使用目的所必须的时间。

| 数据类型                                 | 数据分类 | 存储时间                                                                              |
| :------------------------------------- | :------- | :----------------------------------------------------------- |
| 控制台注册数据                         | 客户资料 | 直到客户帐户被删除或帐户连续 180 天未使用。                      |
| 消息（历史消息、漫游消息、离线消息等） | 用户信息 | 取决于定价计划相关的云存储时间：<li>免费版：3天；<li>基础版：7天；<li>专业版：90 天；<li>企业版：180 天。 |
| 消息附件                                 | 用户信息 | 7 天。                                                                                   |
| 消息回调                                 | 用户信息 | 3 天。                                                                                   |
| 用户资料托管                           | 用户信息 | 直到帐户被删除或帐户连续 180 天未使用。                      |
| 监控数据                               | 运营数据 | 7 天。                                                         |