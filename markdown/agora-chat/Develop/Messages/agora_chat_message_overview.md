即时通讯 IM 支持多种消息类型，开发者可以方便地对本地会话、消息进行管理，可以从服务端获取历史会话和消息，提供送达回执和已读回执能力。

- 消息：即时通讯 IM 中消息（Message）表示发送方给接收方发送的内容，消息包括多种类型，如：文本、图片、语音等。

- 会话：即时通讯 IM 中会话（Conversation）分为 3 种，即单聊、群聊、聊天室会话。
  - 单聊是指两个用户建立的会话，双方可以在会话中收发消息。
  - 群聊会话：会话由群成员发送消息组成，群成员可以在群会话中收发消息。
  - 聊天室会话：会话是由聊天室成员发送的消息组成，聊天室成员可以在会话中收发消息。

### 消息类型

| 类型          | 描述                                                         |
| :------------- | :----------------------------------------------------------- |
| 文本消息       | 文本消息的内容是文本，包含超链接和表情符号等。表情消息基于文本消息实现。<br/> 文本消息大小限制为 3 KB。 |
| 图片消息       | 图片消息是附件消息，需要先将图片上传至消息服务器。接收方收到图片时自动下载图片缩略图。<br/> 图片不能超过 10 MB，图片消息大小限制为 3 KB。 |
| 语音消息       | 语音消息是附件消息，需要先将语音上传至消息服务器。接收方收到语音时自动下载语音。<br/> 音频文件不能超过 10 MB，音频消息大小限制为 3 KB。 |
| 视频消息       | 视频消息是附件消息，需要先将视频上传至消息服务器。接收方收到视频时自动下载视频缩略图，点击下载视频消息。对于 Web 端，视频消息没有缩略图。<br/> 视频文件不能超过 10 MB，视频消息大小限制为 3 KB。 |
| 文件消息       | 文件消息是附件消息，需要先将文件上传至消息服务器。<br/> 附件大小不能超过 10 MB，文件消息大小限制为 3 KB。 |
| 位置消息       | 位置消息需要第三方的地图服务提供经纬度信息。接收方接收到位置消息，通过经纬度信息可以在第三方的地图服务中显示位置。 |
| 透传消息       | 透传消息可视为命令消息。通过发送这条命令给对方，通知对方要执行的操作，对方收到消息后系统可以自定义处理。透传消息不会在 UI 上展示。<br/>消息大小限制为 3 KB。<br> 你可以使用透传消息更新头像和昵称以及进行状态同步等。<br/> 透传消息不会存入本地数据库。 |
| 消息自定义扩展 | 当基础的消息类型不满足需求时，可以使用消息自定义扩展增强基础消息类型。<br/>使用扩展后，消息大小不能超过原类型消息的大小。<br/>典型的用例是发送引用较早文本或图像消息的消息。 |
| 自定义消息     | 开发者自定义的消息类型。自定义消息支持设置类型名称，开发者可以添加多种自定义消息。<br/>自定义消息大小限制为 3 KB。<br/>自定义消息的使用场景：红包消息、模板消息等。 |

#### 消息功能

### 发送和接收消息

聊天用户可在单聊、群聊和聊天室会话中发送和接收消息。

#### 管理本地消息数据

使用即时通讯 IM 发送和接收到的消息会存储在本地数据库，消息以会话为单位进行管理。用户可基于会话获取、删除、导入和插入消息。

<div class="alert note">Web 端无本地消息储存。</div>
| 功能                         | 描述                                                         |
| :--------------------------- | :----------------------------------------------------------- |
| 获取本地会话列表             | 获取本地所有的会话。本地存储的消息有已读和未读状态，获取时包含未读消息数。 |
| 从数据库中读取指定会话的消息 | 从本地数据库获取指定会话的消息，进入会话时，获取会话内容。 |
| 获取指定会话的未读消息数量   | 从本地数据库获取指定会话的未读消息数，显示指定会话的未读消息数。 |
| 获取所有会话的未读消息数量   | 从本地数据库获取所有会话的未读消息数，显示整个应用的未读消息数。 |
| 会话的未读消息数清零              | 查看未读消息后，未读消息数清零。可对指定会话和所有会话进行未读消息数清零。 |
| 删除会话及历史消息           | 删除本地会话，可选择是否删除会话里的历史消息。             |
| 根据消息 ID 搜索消息          | 根据消息 ID 搜索指定的消息。             |
| 获取指定会话中特定类型的消息         | 获取指定会话中特定型的消息。             |
| 获取指定会话中一定时间段内的消息         | 获取指定会话中一定时间段内发送和接收的消息。             |
| 根据关键字搜索会话消息       | 根据关键字对会话里的消息内容进行搜索。                       |
| 导入消息到数据库             | 将外部消息批量导入本地数据库。需构造消息对象。 |
| 插入消息                     | 模拟收到某些消息通知，可以构造一条消息并写入会话。           |

#### 从服务器获取消息

即时通讯 IM 在消息服务器保存历史消息，方便用户在新设备上获取历史消息。

历史消息存储时间与套餐版本相关：免费版 3 天，基础版 7 天， 进阶版 90 天，企业版 自定义保存天数（默认 180 天）。

| 功能                       | 描述                                 | 适用的平台/框架|
| :---------- | :----------- |:----------------------------------- |
| 从服务端分页获取会话列表           | 从服务端分页获取会话列表。               | 所有平台/框架 |
| 分页获取指定会话的历史消息 | 从服务端分页获取会话的历史消息。 | 所有平台/框架 |
| 单向删除服务端的历史消息 | 当前用户单向删除服务端的历史消息。消息删除后，当前用户无法从服务端拉取到该消息，其他用户不受影响。 | 所有平台/框架 |
| 删除服务端会话及其历史消息 | 删除服务端会话及其历史消息。会话删除后，当前用户和其他用户均无法从服务器获取该会话。 | 所有平台/框架 |

#### 获取消息的已读回执和送达回执

即时通讯 IM 消息投递成功会返回送达回执，而且提供消息已读功能，接收方查看消息后会返回已读回执。

| 功能             | 描述                                   |
| :--------------- | :------------------------------------- |
| 单聊消息送达回执     | 消息下发成功后，返回消息送达回执。   |
| 单聊消息已读回执     | 接收方查看消息后，返回消息已读回执。 |
| 单聊会话已读回执 | 接收方查看单聊会话后，返回会话已读回执。             |
| 群组消息已读回执 | 提供群组消息已读回执能力。             |