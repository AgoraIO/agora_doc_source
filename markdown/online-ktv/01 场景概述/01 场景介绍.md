## 场景描述

在线 K 歌房是 Agora 提供的线上 K 歌场景化解决方案，结合 Agora RTC SDK 和 Agora 内容中心等产品，将其复杂的 API 进行模块整合，实现了功能组件化，降低了开发门槛。在此方案中，歌房里的主播可以点歌成为主唱，跟随歌曲伴奏演唱给歌房内的听众，在网络情况优良的条件下还可以实现双人合唱，在演唱过程中：

- 主唱可以控制歌曲的暂停、播放和切换，并且可以自己调节伴奏和人声音量。
- 主唱可以选择合唱模式邀请房间内的其他用户进行合唱。
- 主唱可以开启打分模式，会根据主唱音准的匹配程度，系统给出得分。
- 歌房内有歌词板块，唱歌时会根据歌曲播放进度显示对应的歌词。
- Agora 内容中心提供热门歌曲曲库，主播可以搜索想唱的歌曲，点歌并查看已点列表。
- 听众可以通过上麦点歌进行排麦演唱，并随时与房主和其他连麦主播进行实时音频互动。

**房间内的角色及描述**

| 角色     | 描述                                                         |
| :------- | :----------------------------------------------------------- |
| 房主     | 歌房创建者                                                   |
| 连麦主播 | 进入歌房后，通过上麦成为连麦主播                             |
| 主唱     | 连麦主播点歌后成为主唱，并进行排麦演唱                       |
| 合唱者   | 主唱在合唱模式下点歌可邀请房间内的连麦主播成为合唱者，一起低延时合唱 |
| 听众     | 进入歌房的倾听者                                             |

## 功能列表

在线 K 歌房场景化解决方案提供以下核心功能：

### 实时音频互动

超低延时下，听众实时接收连麦主播的音频流，保证互动的流畅性。

### 互动连麦

听众可自主上麦成为连麦主播，连麦主播之间可以进行实时音频互动，房间内用户可以实时观看连麦主播互动。

### 曲库组件

Agora 内容中心提供热门歌曲的曲库，曲库支持搜索功能。

### 实时合唱

升级实时合唱技术，支持两人及两人以上人合唱，各端相互独立，互不影响，真实还原线下体验

### 点歌排麦

连麦主播从 Agora 内容中心点歌，歌曲进入已点列表；当点歌人数大于1时，根据点歌顺序进行排麦演唱，开始播放歌曲后点歌用户成为主唱。

### 歌曲控制

主唱可以控制歌曲的播放、暂停，切换伴奏/原唱，以及控制伴奏和人声的音量。

### 歌词组件

- 歌曲播放时，根据播放进度显示对应的歌词；
- 滑动歌词可以改变歌曲进度；
- 主唱演唱时显示评分的动画效果；
- 主唱可以改变歌词背景。

### 麦位控制

房主可以对房间内成员进行上麦、下麦操作，同时房间内所有用户都能看到每个麦位的实时状态。

### 低延时耳返

支持耳返功能，在低延时的情况下可以给主唱一个比较真实的反馈。

### 麦位控制

房主可以对房间内成员进行上麦、下麦操作，同时房间内所有用户都能看到每个麦位的实时状态。

### 低延时耳返

支持耳返功能，在低延时的情况下可以给主唱一个比较真实的反馈。

## 技术方案

Agora 使用 Agora RTC SDK 和 Agora 内容中心共同搭建在线 K 歌房场景。

**在线 K 歌独唱方案架构图**

![img](https://web-cdn.agora.io/docs-files/1630049922164)

**在线 K 歌合唱方案架构图**

![](https://web-cdn.agora.io/docs-files/1652092393522)


**各 SDK 或服务实现的功能如下：**

| 产品           | 实现功能                                                     |
| :------------- | :----------------------------------------------------------- |
|Agora SDK  | 加入频道，发布和接收音频流。                            |
| Agora 内容中心 | 提供在线 K 歌房场景所需歌曲及歌曲配套信息，如歌词、专辑封面、海报等。 |
| Agora 歌词组件 | 根据歌曲播放进度实时显示歌词。支持自定义歌词界面布局，更换背景图片等操作。 |
| 第三方云服务   | 实现麦位控制、房间信息和用户信息管理等功能。<br>Agora 在线 K 歌房 demo 中使用的云服务是 Agora 实现的。如果你需要使用相同功能，需要自行部署第三方云服务。 |

## 方案优势

### 版权曲库整合

曲库覆盖热门流行歌曲，一站式接入海量正版数字音乐。歌曲类型丰富多元，满⾜多样化⽤户喜好。

### 九大场景功能

- 支持搜歌点歌、歌词同步、原唱/伴唱切换、歌唱打分、美声音效、实时合唱等九大场景功能，还原线下 KTV 真实场景。
- 50 ms 超低延时耳返，告别走音跑调。

### 模块化组件设计

- 模块化组件设计，降低开发成本，快速搭建 K 歌房。
- 灵活接入各类娱乐社交应用场景，简单调用让 app 有声有色。

### 媲美专业设备音质音效

- 声网 Agora SOLO™、NOVA™ 语音引擎，支持 48 kHz 全频带采样，还原声音高保真度，音频 MOS 分高达 4.7。
- 支持美声和音效，摆脱专业设备和人员束缚，让你的声音更动听、更有趣。